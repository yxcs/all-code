<!DOCTYPE html>
<html>
  <head>
    <title>ç”¨ AngularJS å»ºç«‹åº”ç”¨ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="../static/css/site.css" rel="stylesheet" type="text/css">
    <link href="../../developer.chrome.com/static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="../../developer.chrome.com/static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  </head>

  <body>


<!-- Copyright © 2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  on  12/24/13 11:31:37.<br>
<b>Address:</b> <a class="info" href="https://crxdoc-zh.appspot.com/apps/angular_framework.html">https://crxdoc-zh.appspot.com/apps/angular_framework.html</a><br>
<b>Title:</b> ç”¨ AngularJS å»ºç«‹åº”ç”¨ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰ &nbsp;&bull;&nbsp; <b>Size:</b> 51805<br></div>
<!-- /Copyright © 2005. Spidersoft Ltd -->


    <div id="gc-topnav">
      <table><tr>
      <td id="chrome-logo">
        <a href="apps.html" title="Google Chrome åº”ç”¨" id="view-original">
          <img src="../../developer.chrome.com/static/images/chrome-logo.png" alt=""> chrome
        </a>
        <script type="text/javascript">
          document.getElementById('view-original').href = "https://developer.chrome.com" + location.pathname;
        </script>
        <div id="platform-chooser">
          <button id="platform-chooser-toggle" data-menu="platform-chooser-popup">
            åº”ç”¨ &#x25be;&#x202F;
          </button>
          <div id="platform-chooser-popup">
            <button class="apps" data-href="/apps/about_apps.html"><!--@apps-->åº”ç”¨</button>
            <button class="extensions" data-href="/extensions"><!--@extensions-->æ‰©å±•ç¨‹åº</button>
          </div>
        </div>ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰
      </td>
      <td>
        <ul>
          <li>
            <a href="samples.html"
               title="ç¤ºä¾‹ åº”ç”¨ï¼ˆåŒ…å«æºä»£ç ï¼‰"><!--@Samples-->ç¤ºä¾‹</a>
          </li>
          <li>
            <a href="http://groups.google.com/a/chromium.org/group/chromium-apps"
               title="Google Chrome åº”ç”¨å¼€å‘è€…è®ºå›"
               target="_blank"><!--@Group-->è®ºå›ï¼ˆè‹±æ–‡ï¼‰</a>
          </li>
          <li>
            <a href="http://stackoverflow.com/tags/google-chrome-app/info"
               title="Stack Overflow ä¸Šçš„ [google-chrome-app] æ ‡ç­¾"
               target="_blank">Stack overflow</a>
          </li>
        </ul>
      </td>
      </tr></table>
    </div>
    <div id="gc-topnav-space"></div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <g:plusone></g:plusone>
        <ul 
            class="level1 ">
        <li class="level2">
              <span class="level2">å‘ç°</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="about_apps.html" class="level3 ">ä»€ä¹ˆæ˜¯ Chrome åº”ç”¨ï¼Ÿ</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¼€å‘</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="first_app.html" class="level3 ">åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">æ•™ç¨‹</span>
                <div class="toggleIndicator level3 toggled"></div>
              </a>
            <ul toggleable
                class="level3 ">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">é€šè¿‡ä»£ç å®éªŒå®¤å­¦ä¹ </span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_codelab.html" class="level5 ">å…³äºä»£ç å®éªŒå®¤</a>
              </li><li class="level5">
                    <a href="app_codelab1_setup.html" class="level5 ">1ã€è®¾ç½®å¼€å‘ç¯å¢ƒ</a>
              </li><li class="level5">
                    <a href="app_codelab2_basic.html" class="level5 ">2ã€åˆ›å»ºåŸºæœ¬çš„åº”ç”¨</a>
              </li><li class="level5">
                    <a href="app_codelab3_mvc.html" class="level5 ">3ã€åˆ›å»º MVC</a>
              </li><li class="level5">
                    <a href="app_codelab5_data.html" class="level5 ">4ã€ä¿å­˜å’Œè·å–æ•°æ®</a>
              </li><li class="level5">
                    <a href="app_codelab6_lifecycle.html" class="level5 ">5ã€ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="app_codelab7_useridentification.html" class="level5 ">6ã€è®¿é—®ç”¨æˆ·æ•°æ®</a>
              </li><li class="level5">
                    <a href="app_codelab8_webresources.html" class="level5 ">7ã€è®¿é—®ç½‘ç»œèµ„æº</a>
              </li><li class="level5">
                    <a href="app_codelab_10_publishing.html" class="level5 ">8ã€å‘å¸ƒåº”ç”¨</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">MVC æ¶æ„ä¸æ¡†æ¶</span>
                  <div class="toggleIndicator level4 toggled"></div>
                </a>
              <ul toggleable
                  class="level4 ">
              <li class="level5">
                    <a href="app_frameworks.html" class="level5 ">å…³äº MVC æ¶æ„</a>
              </li><li class="level5">
                    <a  class="level5 selected">ç”¨ AngularJS å»ºç«‹åº”ç”¨</a>
              </li><li class="level5">
                    <a href="sencha_framework.html" class="level5 ">ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨</a>
              </li>
              </ul>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">Chrome åº”ç”¨çš„æ¦‚å¿µ</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">åŸºç¡€çŸ¥è¯†</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_architecture.html" class="level5 ">åº”ç”¨çš„æ¶æ„</a>
              </li><li class="level5">
                    <a href="app_lifecycle.html" class="level5 ">åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="offline_apps.html" class="level5 ">é¦–å…ˆè€ƒè™‘ç¦»çº¿</a>
              </li><li class="level5">
                    <a href="app_external.html" class="level5 ">å¤–éƒ¨å†…å®¹</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å®‰å…¨æ€§</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="contentSecurityPolicy.html" class="level5 ">å†…å®¹å®‰å…¨ç­–ç•¥</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å°†æ‚¨çš„åº”ç”¨ä¸äº‘ç«¯ç»“åˆ</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘æ¶ˆæ¯æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="cloudMessaging.html" class="level6 ">å…³äºäº‘æ¶ˆæ¯æœåŠ¡</a>
                </li><li class="level6">
                      <a href="pushMessaging.html" class="level6 ">å®¢æˆ·ç«¯å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="gcm_server.html" class="level6 ">æœåŠ¡å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="gcm_tos.html" class="level6 ">æœåŠ¡æ¡æ¬¾</a>
                </li>
                </ul>
              </li><li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘å­˜å‚¨æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="storage.html" class="level6 ">chrome.storage</a>
                </li>
                </ul>
              </li><li class="level5">
                    <a href="app_identity.html" class="level5 ">ç”¨æˆ·è®¤è¯</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å­˜å‚¨ä¸è·å–æ•°æ®</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_storage.html" class="level5 ">å­˜å‚¨ API</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä½¿ç”¨ä½çº§ç³»ç»ŸæœåŠ¡</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_usb.html" class="level5 ">USB</a>
              </li><li class="level5">
                    <a href="app_serial.html" class="level5 ">ä¸²è¡Œç«¯å£</a>
              </li><li class="level5">
                    <a href="app_network.html" class="level5 ">ç½‘ç»œé€šä¿¡</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä¸ä¸»æœºå¹³å°äº¤äº’</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="desktop_notifications.html" class="level5 ">ä¸°å¯Œçš„é€šçŸ¥</a>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‘å¸ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="publish_app.html" class="level3 ">å‘å¸ƒæ‚¨çš„åº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">é€šè¿‡æ‚¨çš„åº”ç”¨è·åˆ©</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="google_wallet.html" class="level4 ">ç”¨äºæ•°å­—å•†å“çš„ Google ç”µå­é’±åŒ…</a>
            </li>
            </ul>
          </li><li class="level3">
                <a href="analytics.html" class="level3 ">Analyticsï¼ˆåˆ†æï¼‰</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‚è€ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="api_index.html" class="level3 ">Chrome å¹³å° API</a>
          </li><li class="level3">
                <a href="tags/webview.html" class="level3 ">Webview æ ‡ç­¾</a>
          </li><li class="level3">
                <a href="api_other.html" class="level3 ">ç½‘é¡µ API</a>
          </li><li class="level3">
                <a href="manifest.html" class="level3 ">æ¸…å•æ–‡ä»¶æ ¼å¼</a>
          </li><li class="level3">
                <a href="app_deprecated.html" class="level3 ">ç¦ç”¨çš„ç½‘é¡µç‰¹æ€§</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">ç¤ºä¾‹</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="samples.html" class="level3 ">ç¤ºä¾‹åº”ç”¨</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¸®åŠ©</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="faq.html" class="level3 ">å¸¸è§é—®é¢˜</a>
          </li><li class="level3">
                <a href="https://groups.google.com/a/chromium.org/forum/#!forum/chromium-apps" class="level3 ">Google ç½‘ä¸Šè®ºå›</a>
          </li><li class="level3">
                <a href="http://stackoverflow.com/questions/tagged/google-chrome-app" class="level3 ">Stack Overflow</a>
          </li>
          </ul>
        </li>
        </ul>
      </div>
      <div id="gc-pagecontent">

<div id="toc">
  <ol>
    <li >
      <a href="#first"
         data-list-item
         >å…³äºè¯¥åº”ç”¨</a>
    </li>
    <li >
      <a href="#second"
         data-list-item
         >åˆ›å»ºæ¸…å•æ–‡ä»¶</a>
    </li>
    <li >
      <a href="#three"
         data-list-item
         >åˆ›å»ºäº‹ä»¶é¡µé¢</a>
    </li>
    <li >
      <a href="#four"
         data-list-item
         >ä»¥ Angular çš„æ–¹å¼è®¾è®¡åº”ç”¨</a>
      <ol>
        <li >
          <a href="#view"
             data-list-item
             >åˆ›å»ºè§†å›¾</a>
        </li>
        <li >
          <a href="#csp"
             data-list-item
             >æœ‰å…³å†…å®¹å®‰å…¨ç­–ç•¥çš„ä¸€äº›è¯´æ˜</a>
        </li>
        <li >
          <a href="#authorization"
             data-list-item
             >è¿›è¡Œè®¤è¯</a>
        </li>
        <li >
          <a href="#skeleton"
             data-list-item
             >åŸºæœ¬æ§åˆ¶å™¨</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#five"
         data-list-item
         >è·å–æ•°æ®</a>
      <ol>
        <li >
          <a href="#import"
             data-list-item
             >å¯¼å…¥è¿œç¨‹å›¾ç‰‡èµ„æº</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#six"
         data-list-item
         >æ”¯æŒç¦»çº¿ï¼šç¼“å­˜å¤–éƒ¨èµ„æº</a>
    </li>
    <li >
      <a href="#seven"
         data-list-item
         >é€šè¿‡æ‹–æ”¾ä¸Šä¼ </a>
    </li>
  </ol>
</div>

<meta name="doc-family" content="apps">
<h1><!--@Build Apps with AngularJS-->ç”¨ AngularJS å»ºç«‹åº”ç”¨</h1>
<!--Article written by Eric Bidelman-->
<p>
<!--@This guide gets you started building Chrome Apps
with the-->
è¿™ä¸€æŒ‡å—ä½¿æ‚¨åˆæ­¥äº†è§£å¦‚ä½•ä½¿ç”¨
<a href="http://angularjs.org/">AngularJS</a> MVC <!--@framework.
To illustrate Angular in action,
we'll be referencing an actual app built using the framework,
the Google Drive Uploader.
The <a href="https://github.com/GoogleChrome/chrome-app-samples/tree/master/gdrive">source code</a>
is available on GitHub.-->
æ¡†æ¶å»ºç«‹ Chrome åº”ç”¨ã€‚ä¸ºäº†ä»¥å®é™…ä¾‹å­æ¼”ç¤º
Angularï¼Œæˆ‘ä»¬å°†å¼•ç”¨ä¸€ä¸ªä½¿ç”¨è¯¥æ¡†æ¶å»ºç«‹çš„å®é™…çš„åº”ç”¨â€”â€”Google Drive
Uploaderï¼ˆGoogle äº‘ç«¯ç¡¬ç›˜ä¸Šä¼ å™¨ï¼‰ï¼Œ<a href="https://github.com/GoogleChrome/chrome-app-samples/tree/master/gdocs">æºä»£ç </a>åœ¨
GitHub ä¸Šå¯ç”¨ã€‚
</p>

<h2 id="first"><!--@About the app-->å…³äºè¯¥åº”ç”¨</h2>

<img src="https://developer.chrome.com/static/images/uploader.png"
     width="296"
     height="347"
     style="float: right; padding-left: 5px"
     alt="Google Drive Uploader">

<p>
<!--@The--> Google Drive Uploader <!--@allows users to quickly view and interact
with files stored in their Google Drive account
as well as upload new files using the
<a href="http://www.html5rocks.com/en/tutorials/dnd/basics/">HTML Drag and Drop APIs</a>.
It's a great example of building an app which talks
to one of <a href="https://developers.google.com/apis-explorer/#p/">Google's APIs</a>;
in this case, the Google Drive API.-->
å…è®¸ç”¨æˆ·å¿«é€Ÿåœ°æŸ¥çœ‹ä»–ä»¬åœ¨ Google äº‘ç«¯ç¡¬ç›˜ä¸­å­˜å‚¨çš„æ–‡ä»¶å¹¶ä¸ä¹‹äº¤äº’ï¼Œè¿˜å¯ä»¥ä½¿ç”¨
<a href="http://www.html5rocks.com/en/tutorials/dnd/basics/">HTML æ‹–æ”¾
API</a>
ä¸Šä¼ æ–°çš„æ–‡ä»¶ã€‚å»ºç«‹ä¸æŸä¸ª
<a href="https://developers.google.com/apis-explorer/#p/">Google çš„
API</a>ï¼ˆåœ¨æ­¤ä¾‹å­ä¸­å³ Google Drive APIï¼‰äº¤äº’åº”ç”¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚
</p>

<p class="note">
<strong><!--@Note: -->æ³¨æ„ï¼š</strong><!--@
You can also build apps which talk to 3rd party APIs/services
that are OAuth2-enabled.
See <a href="https://crxdoc-zh.appspot.com/apps/app_identity.html#non">non-Google Account authentication</a>.-->æ‚¨ä¹Ÿå¯ä»¥å»ºç«‹åº”ç”¨ï¼Œä¸å¯ç”¨äº†
OAuth2 çš„ç¬¬ä¸‰æ–¹ API/æœåŠ¡äº¤äº’ã€‚è¯·å‚è§<a
href="https://crxdoc-zh.appspot.com/apps/app_identity.html#non">é Google å¸æˆ·çš„è®¤è¯</a>ã€‚
</p>

<p>
<!--@The Uploader uses OAuth2 to access the user's data. The
<a href="identity.html">chrome.identity API</a>
handles fetching an OAuth token for the logged-in user,
so the hard work is done for us!
Once we have a long-lived access token,
the apps uses the
<a href="https://developers.google.com/drive/get-started">Google Drive API</a>
to access the user's data.-->
ä¸Šä¼ å™¨ä½¿ç”¨ OAuth2 è®¿é—®ç”¨æˆ·æ•°æ®ã€‚<a
href="identity.html">chrome.identity</a> API
å¯ä»¥ä¸ºå·²ç™»å½•ç”¨æˆ·è·å– OAuth
ä»¤ç‰Œï¼Œæ‰€ä»¥è¿™äº›éº»çƒ¦çš„å·¥ä½œå·²ç»ä¸ºæˆ‘ä»¬åšå¥½äº†ï¼ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†é•¿æ—¶é—´æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼Œåº”ç”¨å°±å¯ä»¥ä½¿ç”¨
<a href="https://developers.google.com/drive/get-started">Google Drive API</a>
è®¿é—®ç”¨æˆ·æ•°æ®ã€‚
</p>

<p>
<!--@Key features this app uses:-->
è¯¥åº”ç”¨ä½¿ç”¨çš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š
</p>

<ul>
    <li>Angular JS<!--@'s autodetection for-->å¯¹
        <a href="contentSecurityPolicy.html">CSP</a>
        çš„è‡ªåŠ¨æ£€æµ‹
    </li>
    <li><!--@Render a list of files fetched from the-->æ˜¾ç¤ºä»
        <a href="https://developers.google.com/drive/get-started">Google Drive API</a>
        è·å–çš„æ–‡ä»¶åˆ—è¡¨
    </li>
    <li>ä½¿ç”¨ <a href="http://www.html5rocks.com/en/tutorials/file/filesystem/">HTML5 <!--@Filesystem-->æ–‡ä»¶ç³»ç»Ÿ API</a>
        <!--@to store file icons offline-->
        ç¦»çº¿ä¿å­˜æ–‡ä»¶å›¾æ ‡
    </li>
    <li>ä½¿ç”¨ <a href="http://www.html5rocks.com/en/tutorials/dnd/basics/">HTML5 <!--@Drag and Drop-->æ‹–æ”¾ API</a>
        <!--@for importing/uploading new files from the desktop-->
        å¯¼å…¥/ä¸Šä¼ æ¡Œé¢ä¸Šçš„æ–°æ–‡ä»¶
    </li>
    <li>ä½¿ç”¨ XHR2 <!--@to load images, cross-domain-->è·¨åŸŸåŠ è½½å›¾ç‰‡</li>
    <li>ä½¿ç”¨ <a href="app_identity.html">chrome.identity API</a>
        <!--@for OAuth authorization-->è¿›è¡Œ OAuth è®¤è¯</li>
    <li><!--@Chromeless frames to define the app's own navbar look and feel-->
        ä½¿ç”¨æ— è¾¹æ¡†æ¡†æ¶å®šä¹‰åº”ç”¨è‡ªå·±çš„å¯¼èˆªæ æ ·å¼ä¸ä½“éªŒ
    </li>
</ul>

<h2 id="second"><!--@Creating the manifest-->åˆ›å»ºæ¸…å•æ–‡ä»¶</h2>

<p>
<!--@All Chrome Apps require a <code>manifest.json</code> file
which contains the information Chrome needs to launch the app.
The manifest contains relevant metadata and
lists any special permissions the app needs to run.-->
æ‰€æœ‰ Chrome åº”ç”¨éƒ½éœ€è¦ä¸€ä¸ª
<code>manifest.json</code> æ–‡ä»¶ï¼ŒåŒ…å« Chrome
æµè§ˆå™¨å¯åŠ¨åº”ç”¨æ‰€éœ€çš„ä¿¡æ¯ã€‚æ¸…å•æ–‡ä»¶åŒ…å«ç›¸å…³çš„å…ƒæ•°æ®ï¼Œå¹¶åˆ—å‡ºåº”ç”¨è¿è¡Œæ—¶éœ€è¦çš„æ‰€æœ‰ç‰¹æ®Šæƒé™ã€‚
</p>

<p>
<!--@A stripped down version of the Uploader's manifest looks like this:-->
ä¸Šä¼ å™¨æ¸…å•æ–‡ä»¶çš„ç®€åŒ–ç‰ˆæœ¬å¦‚ä¸‹æ‰€ç¤ºï¼š
</p>

<pre data-filename="manifest.json">
{
  "name": "Google Drive Uploader",
  "version": "0.0.1",
  "manifest_version": 2,
  "oauth2": {
    "client_id": "665859454684.apps.googleusercontent.com",
    "scopes": [
      "https://www.googleapis.com/auth/drive"
    ]
  },
 ...
  "permissions": [
    "https://docs.google.com/feeds/",
    "https://docs.googleusercontent.com/",
    "https://spreadsheets.google.com/feeds/",
    "https://ssl.gstatic.com/",
    "https://www.googleapis.com/"
  ]
}
</pre>

<p>
<!--@The most important parts of this manifest are the "oauth2" and "permissions" sections.-->
è¯¥æ¸…å•æ–‡ä»¶æœ€é‡è¦çš„éƒ¨åˆ†å°±æ˜¯ "oauth2" ä¸ "permissions" éƒ¨åˆ†ã€‚
</p>

<p>
<!--@The "oauth2" section defines the required parameters by OAuth2 to do its magic.
To create a "client_id", follow the instructions in
<a href="https://crxdoc-zh.appspot.com/apps/app_identity.html#client_id">Get your client id</a>.
The "scopes" list the authorization scopes
that the OAuth token will be valid for (for example, the APIs the app wants to access).-->
"oauth2" éƒ¨åˆ†å®šä¹‰äº† OAuth2 éœ€è¦çš„å‚æ•°ä»¥ä¾¿å®Œæˆå®ƒçš„å·¥ä½œã€‚è¦åˆ›å»ºä¸€ä¸ª
"client_id"ï¼Œéµå¾ª<a
href="https://crxdoc-zh.appspot.com/apps/app_identity.html#client_id">è·å–æ‚¨çš„å®¢æˆ·ç«¯æ ‡è¯†ç¬¦</a>ä¸­çš„æŒ‡ç¤ºã€‚"scopes"
åˆ—å‡ºäº† OAuth ä»¤ç‰Œæœ‰æ•ˆçš„è®¤è¯åŸŸï¼ˆä¾‹å¦‚åº”ç”¨éœ€è¦è®¿é—®çš„ APIï¼‰ã€‚
</p>

<p>
<!--@The "permissions" section includes URLs that the app will access via XHR2.
The URL prefixes are required in order for Chrome
to know which cross-domain requests to allow.-->
"permissions" éƒ¨åˆ†åŒ…å«åº”ç”¨é€šè¿‡ XHR2 è®¿é—®çš„ URLã€‚URL
å‰ç¼€æ˜¯å¿…é¡»çš„ï¼Œè¿™æ · Chrome æµè§ˆå™¨æ‰èƒ½çŸ¥é“å…è®¸å“ªäº›è·¨åŸŸè¯·æ±‚ã€‚
</p>

<h2 id="three"><!--@Creating the event page-->åˆ›å»ºäº‹ä»¶é¡µé¢</h2>

<p>
<!--@All Chrome Apps require a background script/page
to launch the app and respond to system events.-->
æ‰€æœ‰ Chrome åº”ç”¨éƒ½éœ€è¦ä¸€ä¸ªåå°è„šæœ¬/ç½‘é¡µæ‰èƒ½è¿è¡Œåº”ç”¨ï¼Œå¹¶å“åº”ç³»ç»Ÿäº‹ä»¶ã€‚
</p>

<p>
<!--@In its-->
åœ¨å®ƒçš„
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/js/background.js">background.js</a> 
<!--@script,
Drive Uploader opens a 500x600px window to the main page.
It also specifies a minimum height and width for the window
so the content doesn't become too crunched: -->
è„šæœ¬ä¸­ï¼Œäº‘ç«¯ç¡¬ç›˜ä¸Šä¼ å™¨æ‰“å¼€ä¸€ä¸ª 500Ã—600
åƒç´ çš„çª—å£æ˜¾ç¤ºä¸»é¡µé¢ï¼ŒåŒæ—¶å®ƒä¹ŸæŒ‡å®šäº†çª—å£çš„æœ€å°é«˜åº¦ä¸å®½åº¦ï¼Œä»¥å…å†…å®¹æ˜¾å¾—è¿‡äºç´§å‡‘ã€‚
</p>

<pre data-filename="background.js">
chrome.app.runtime.onLaunched.addListener(function(launchData) {
  chrome.app.window.create('../main.html', {
    bounds: {
      width: 500,
      height: 600
    },
    minWidth: 500,
    minHeight: 600,
    frame: 'none'
  });
});
</pre>

<p>
<!--@The window is created as a chromeless window (frame: 'none').
By default, windows render with the OS's default close/expand/minimize bar:-->
çª—å£ä»¥æ— è¾¹æ¡†çª—å£çš„å½¢å¼åˆ›å»ºï¼ˆframe: 'none'ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œçª—å£æ¸²æŸ“æ—¶å°†æ˜¾ç¤ºæ“ä½œç³»ç»Ÿé»˜è®¤çš„å…³é—­/æœ€å¤§åŒ–/æœ€å°åŒ–æ ï¼š
</p>

<img src="https://developer.chrome.com/static/images/noframe.png"
     width="508"
     height="75"
     alt="Google Drive Uploader with no frame">

<p>
<!--@The Uploader uses <code>frame: 'none'</code> to render the window as a "blank slate"
and creates a custom close button in <code>main.html</code>:-->
ä¸Šä¼ å™¨ä½¿ç”¨ <code>frame: 'none'</code> ä½¿çª—å£æ¸²æŸ“ä¸ºâ€œç™½æ¿â€ï¼Œå¹¶åœ¨
<code>main.html</code> ä¸­åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å…³é—­æŒ‰é’®ï¼š
</p>

<img src="https://developer.chrome.com/static/images/customframe.png"
     width="504"
     height="50"
     alt="Google Drive Uploader with custom frame">

<p>
<!--@The entire navigational area is wrapped in a &lt;nav> (see next section).
To declutter the app a bit,
the custom close button is hidden until the user interacts with this the area:-->
æ•´ä¸ªå¯¼èˆªåŒºåŸŸåŒ…æ‹¬åœ¨ &lt;nav&gt;
æ ‡ç­¾ä¸­ï¼ˆå‚è§ä¸‹ä¸€èŠ‚ï¼‰ã€‚ä¸ºäº†ä½¿åº”ç”¨æ›´ç®€æ´ä¸€äº›ï¼Œè‡ªå®šä¹‰æŒ‰é’®ä¸€å¼€å§‹æ˜¯éšè—çš„ï¼Œç›´åˆ°ç”¨æˆ·ä¸è¯¥åŒºåŸŸäº¤äº’ï¼š
</p>

<pre data-filename="main.css">
&lt;style&gt;
nav:hover #close-button {
  opacity: 1;
}

#close-button {
  float: right;
  padding: 0 5px 2px 5px;
  font-weight: bold;
  opacity: 0;
  -webkit-transition: all 0.3s ease-in-out;
}
&lt;/style&gt;
</pre>
<pre data-filename="main.html">
&lt;button class="btn" id="close-button" title="Close"&gt;x&lt;/button&gt;
</pre>

<p>
<!--@In-->
åœ¨
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/js/app.js">app.js</a><!--@,
this button is hooked up to <code>window.close()</code>.-->
ä¸­ï¼Œè¯¥æŒ‰é’®å°†è°ƒç”¨ <code>window.close()</code>ã€‚
</p>

<h2 id="four"><!--@Designing the app the Angular way-->ä»¥ Angular çš„æ–¹å¼è®¾è®¡åº”ç”¨</h2>

<p>
<!--@Angular is an MVC framework, so we need to define the app in such a way that a 
model, view, and controller logically fall out of it. Luckily, this is trivial when using Angular.-->
Angular æ˜¯ä¸€ä¸ª MVC
æ¡†æ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»¥è¿™æ ·çš„æ–¹å¼å®šä¹‰åº”ç”¨ï¼Œä½¿æ¨¡å‹ã€è§†å›¾ä¸æ§åˆ¶å™¨ä»¥é€»è¾‘çš„æ–¹å¼åœ¨åº”ç”¨ä¸­ä½“ç°å‡ºæ¥ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨
Angular æ—¶è¿™æ˜¯å¾ˆæ™®é€šçš„ã€‚
</p>

<p>
<!--@The View is the easiest, so let's start there.-->
è§†å›¾æ˜¯æœ€ç®€å•çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹ã€‚
</p>

<h3 id="view"><!--@Creating the view-->åˆ›å»ºè§†å›¾</h3>

<p>
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/main.html">main.html</a>
<!--@is the "V" in MVC; where we define HTML templates to render data into.
In Angular, templates are simple blocks of HTML with some special sauce.-->
æ˜¯ MVC ä¸­çš„â€œVâ€ï¼ˆè§†å›¾ï¼‰ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­å®šä¹‰å‘ˆç°æ•°æ®çš„ HTML æ¨¡æ¿ã€‚åœ¨ Angular
ä¸­ï¼Œæ¨¡æ¿æ˜¯åŒ…å«æŸäº›ç‰¹æ®Šå†…å®¹çš„ç®€å• HTML å—ã€‚
</p>

<p>
<!--@Ultimately we want to display the user's list of files.
For that, a simple &lt;ul&gt; list makes sense.
The Angular bits are highlighted in bold: -->
æœ€ç»ˆæˆ‘ä»¬å¸Œæœ›æ˜¾ç¤ºç”¨æˆ·çš„æ–‡ä»¶åˆ—è¡¨ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„
&lt;ul&gt; åˆ—è¡¨ã€‚Angular çš„ç‰¹æœ‰å†…å®¹ä»¥ç²—ä½“é«˜äº®ï¼š
</p>

<pre data-filename="main.html">
&lt;ul&gt;
  &lt;li <strong>data-ng-repeat="doc in docs"</strong>&gt;
    &lt;img data-ng-src=<strong>"&#123;{doc.icon}&#125;"</strong>&gt; &lt;a href=<strong>"&#123;{doc.alternateLink}&#125;"</strong>&gt;<strong>&#123;{doc.title}&#125;</strong>&lt;/a&gt;
<strong>&#123;{doc.size}&#125;</strong>
    &lt;span class="date"&gt;<strong>&#123;{doc.updatedDate}&#125;</strong>&lt;/span&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</pre>

<p>
<!--@This reads exactly as it looks:
stamp out an &lt;li> for every doc in our data model "docs".
Each item contains a file icon, link to open the file on the web,
and last updatedDate.-->
å®ƒç†è§£èµ·æ¥ä¸çœ‹ä¸Šå»çš„æ ·å­å®Œå…¨ä¸€è‡´ï¼šåœ¨æˆ‘ä»¬çš„æ•°æ®æ¨¡å‹â€œdocsâ€ä¸­ä¸ºæ¯ä¸€ä¸ªæ–‡æ¡£äº§ç”Ÿä¸€ä¸ª
&lt;li&gt;ï¼Œæ¯ä¸€é¡¹åŒ…å«ä¸€ä¸ªæ–‡ä»¶å›¾æ ‡ã€åœ¨ç½‘é¡µä¸­æ‰“å¼€æ–‡ä»¶çš„é“¾æ¥ä»¥åŠæœ€åæ›´æ–°æ—¥æœŸã€‚
</p>

<p class="note">
<strong><!--@Note: -->æ³¨æ„ï¼š</strong><!--@
To make the template valid HTML,
we're using <code>data-*</code> attributes for Angular's
<a href="http://docs.angularjs.org/api/ng.directive:ngRepeat">ngRepeat</a> iterator,
but you don't have to.
You could easily write the repeater as <code>&lt;li ng-repeat="doc in docs"></code>.-->ä¸ºäº†ä½¿æ¨¡æ¿æˆä¸ºæœ‰æ•ˆçš„
HTMLï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>data-*</code> å±æ€§ä½œä¸º Angular çš„
<a href="http://docs.angularjs.org/api/ng.directive:ngRepeat">ngRepeat</a>
è¿­ä»£å™¨ï¼Œä½†æ‚¨ä¸ä¸€å®šè¦è¿™ä¹ˆåšã€‚æ‚¨å¯ä»¥ç®€å•åœ°å°†é‡å¤å™¨å†™ä¸º
<code>&lt;li ng-repeat="doc in docs"&gt;</code>ã€‚
</p>

<p>
<!--@Next, we need to tell Angular which controller will oversee this template's rendering.
For that, we use the-->
æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ Angular
å“ªä¸ªæ§åˆ¶å™¨å°†ä¼šæ§åˆ¶è¯¥æ¨¡æ¿çš„æ¸²æŸ“ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨
<a href="http://docs.angularjs.org/api/ng.directive:ngController">ngController</a>
<!--@directive to tell the <code>DocsController</code> to have reign over the template &lt;body&gt;:-->
æŒ‡ç¤ºç¬¦è®© <code>DocsController</code> æ§åˆ¶æ¨¡æ¿çš„ &lt;body&gt;ã€‚
</p>

<pre data-filename="main.html">
&lt;body <strong>data-ng-controller="DocsController"</strong>&gt;
&lt;section id="main"&gt;
  &lt;ul&gt;
    &lt;li data-ng-repeat="doc in docs"&gt;
      &lt;img data-ng-src="&#123;{doc.icon}&#125;"&gt; &lt;a href="&#123;{doc.alternateLink}&#125;"&gt;&#123;{doc.title}&#125;&lt;/a&gt; &#123;{doc.size}&#125;
      &lt;span class="date"&gt;&#123;{doc.updatedDate}&#125;&lt;/span&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/section&gt;
&lt;/body&gt;
</pre>

<p>
<!--@Keep in mind,
what you don't see here is us hooking up event listeners or properties for data binding.
Angular is doing that heavy lifting for us!-->
å€¼å¾—æ³¨æ„çš„æ˜¯æ‚¨åœ¨è¿™é‡Œå¹¶æ²¡æœ‰çœ‹åˆ°æˆ‘ä»¬è®¾ç½®äº‹ä»¶ç›‘å¬å™¨æˆ–ç”¨äºæ•°æ®ç»‘å®šçš„å±æ€§ï¼ŒAngular
ä¸ºæˆ‘ä»¬å®Œæˆäº†è¿™äº›ç¹é‡çš„ä»»åŠ¡ï¼
</p>

<p>
<!--@The last step is to make Angular light up our templates.
The typical way to do that is include the-->
æœ€åä¸€æ­¥æ˜¯è®© Angular ä½¿æˆ‘ä»¬çš„æ¨¡æ¿ç”Ÿæ•ˆï¼Œåšåˆ°è¿™ä¸€ç‚¹çš„é€šå¸¸æ–¹æ³•æ˜¯ç›´æ¥åœ¨
&lt;html&gt; ä¸ŠåŒ…å«
<a href="http://docs.angularjs.org/api/ng.directive:ngApp">ngApp</a>
<!--@directive all the way up on &lt;html>:-->
æŒ‡ç¤ºç¬¦ï¼š
</p>

<pre data-filename="main.html">
&lt;html <strong>data-ng-app="gDriveApp"</strong>&gt;
</pre>

<p>
<!--@You could also scope the app down
to a smaller portion of the page if you wanted to.
We only have one controller in this app,
but if we were to add more later,
putting-->
å¦‚æœæ‚¨æ„¿æ„çš„è¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°†åº”ç”¨é™åˆ¶åœ¨é¡µé¢ä¸­æŸä¸€ä¸ªè¾ƒå°çš„éƒ¨åˆ†ã€‚åœ¨è¿™ä¸€åº”ç”¨ä¸­æˆ‘ä»¬åªæœ‰ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œä½†æ˜¯å¦‚æœä»Šåæˆ‘ä»¬éœ€è¦å¢åŠ æ›´å¤šï¼Œå°†
<a href="http://docs.angularjs.org/api/ng.directive:ngApp">ngApp</a>
<!--@on the topmost element makes the entire page Angular-ready.-->
æ”¾åœ¨é¡¶å±‚å…ƒç´ å°†ä½¿æ•´ä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨ Angularã€‚
</p>

<p>
<!--@The final product for <code>main.html</code> looks something like this:-->
<code>main.html</code> çš„æœ€ç»ˆäº§å“å¦‚ä¸‹æ‰€ç¤ºï¼š
</p>

<pre data-filename="main.html">
&lt;html <strong>data-ng-app="gDriveApp"</strong>&gt;
&lt;head&gt;
  â€¦
  <!-- crbug.com/120693: so we don't need target="_blank" on every anchor. -->
  &lt;base target="_blank"&gt;
&lt;/head&gt;
&lt;body <strong>data-ng-controller="DocsController"</strong>&gt;
&lt;section id="main"&gt;
  &lt;nav&gt;
    &lt;h2&gt;Google Drive Uploader&lt;/h2&gt;
    &lt;button class="btn" <strong>data-ng-click="fetchDocs()"</strong>&gt;Refresh&lt;/button&gt;
    &lt;button class="btn" id="close-button" title="Close"&gt;&lt;/button&gt;
  &lt;/nav&gt;
  &lt;ul&gt;
    &lt;li <strong>data-ng-repeat="doc in docs"</strong>&gt;
      &lt;img data-ng-src=<strong>"&#123;{doc.icon}&#125;"</strong>&gt; &lt;a href=<strong>"&#123;{doc.alternateLink}&#125;"</strong>&gt;<strong>&#123;{doc.title}&#125;</strong>&lt;/a&gt;  <strong>&#123;{doc.size}&#125;</strong>
      &lt;span class="date"&gt;<strong>&#123;{doc.updatedDate}&#125;</strong>&lt;/span&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/section&gt;
</pre>

<h3 id="csp"><!--@A word on Content Security Policy-->æœ‰å…³å†…å®¹å®‰å…¨ç­–ç•¥çš„ä¸€äº›è¯´æ˜</h3>

<p>
<!--@Unlike many other JS MVC frameworks,
Angular v1.1.0+ requires no tweaks to work within a strict
<a href="contentSecurityPolicy.html">CSP</a>.
It just works, out of the box!-->
ä¸è®¸å¤šå…¶ä»– JS MVC æ¡†æ¶ä¸åŒï¼ŒAngular v1.1.0+ ä¸éœ€è¦ä»»ä½•è°ƒæ•´å°±èƒ½åœ¨ä¸¥æ ¼çš„
<a href="contentSecurityPolicy.html">CSP</a> ä¸‹å·¥ä½œã€‚å®ƒçœŸçš„å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼
</p>

<p>
<!--@However, if you're using an older version
of Angular between v1.0.1 and v1.1.0,
you'll need tell Angular to run in a "content security mode".
This is done by including the
<a href="http://docs.angularjs.org/api/ng.directive:ngCsp">ngCsp</a>
directive alongside <a href="http://docs.angularjs.org/api/ng.directive:ngApp">ngApp</a>:-->
ç„¶è€Œï¼Œå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ Angular çš„æ—§ç‰ˆæœ¬ï¼ˆv1.0.1 ä¸ v1.1.0 ä¹‹é—´ï¼‰ï¼Œæ‚¨éœ€è¦è®©
Angular è¿è¡Œåœ¨â€œå†…å®¹å®‰å…¨æ¨¡å¼â€ä¸‹ï¼Œåœ¨ä½¿ç”¨
<a href="http://docs.angularjs.org/api/ng.directive:ngApp">ngApp</a>
çš„åŒæ—¶åŒ…å«
<a href="http://docs.angularjs.org/api/ng.directive:ngCsp">ngCsp</a>
æŒ‡ç¤ºç¬¦å³å¯åšåˆ°è¿™ä¸€ç‚¹ã€‚
</p>

<pre data-filename="main.html">
&lt;html data-ng-app data-ng-csp&gt;
</pre>

<h3 id="authorization"><!--@Handling authorization-->è¿›è¡Œè®¤è¯</h3>

<p>
<!--@The data model isn't generated by the app itself.
Instead, it's populated from an external API (the Google Drive API).
Thus, there's a bit of work necessary in order to populate the app's data.-->
æ•°æ®æ¨¡å‹å¹¶ä¸æ˜¯ç”±åº”ç”¨è‡ªå·±ç”Ÿæˆçš„ï¼Œè€Œæ˜¯ä»å¤–éƒ¨
APIï¼ˆGoogle Drive APIï¼‰è·å–çš„ã€‚å› æ­¤ï¼Œä¸ºäº†è·å–åº”ç”¨çš„æ•°æ®æœ‰å¿…è¦åšä¸€äº›äº‹æƒ…ã€‚
</p>

<p>
<!--@Before we can make an API request,
we need to fetch an OAuth token for the user's Google Account.
For that, we've created a method to wrap the call
to <code>chrome.identity.getAuthToken()</code> and
store the <code>accessToken</code>,
which we can reuse for future calls to the Drive API.-->
åœ¨æˆ‘ä»¬è°ƒç”¨ API è¯·æ±‚å‰ï¼Œæˆ‘ä»¬éœ€è¦è·å–ç”¨æˆ· Google å¸æˆ·çš„ OAuth
ä»¤ç‰Œã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–¹æ³•åŒ…è£…å¯¹
<code>chrome.identity.getAuthToken()</code>
çš„è°ƒç”¨ï¼Œå¹¶ä¿å­˜ <code>accessToken</code>ï¼Œä»¥ä¾¿å°†æ¥è°ƒç”¨ Drive API æ—¶å†æ¬¡ä½¿ç”¨ã€‚
</p>

<pre data-filename="gdocs.js">
GDocs.prototype.auth = function(opt_callback) {
  try {
    <strong>chrome.identity.getAuthToken({interactive: false}, function(token) {</strong>
      if (token) {
        this.accessToken = token;
        opt_callback &amp;&amp; opt_callback();
      }
    }.bind(this));
  } catch(e) {
    console.log(e);
  }
};
</pre>

<p class="note">
<strong><!--@Note: -->æ³¨æ„ï¼š</strong><!--@
Passing the optional callback gives us the flexibility
of knowing when the OAuth token is ready.-->ä¼ é€’å¯é€‰çš„å›è°ƒå‡½æ•°ä½¿æˆ‘ä»¬å¯ä»¥çµæ´»åœ°çŸ¥é“
OAuth ä»¤ç‰Œä»€ä¹ˆæ—¶å€™å·²ç»å‡†å¤‡å¥½ã€‚
</p>

<p class="note">
<strong><!--@Note: -->æ³¨æ„ï¼š</strong><!--@
To simplify things a bit,
we've created a library,-->ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/js/gdocs.js">gdocs.js</a>
<!--@to handle API tasks.-->
åº“å¤„ç† API ä»»åŠ¡ã€‚
</p>

<p>
<!--@Once we have the token,
it's time to make requests against the Drive API and populate the model.-->
ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†ä»¤ç‰Œï¼Œç°åœ¨å¯ä»¥å‘ Drive API å‘å‡ºè¯·æ±‚äº†ï¼Œå¹¶è·å–æ¨¡å‹ã€‚
</p>

<h3 id="skeleton"><!--@Skeleton controller-->åŸºæœ¬æ§åˆ¶å™¨</h3>

<p>
<!--@The "model" for the Uploader is a simple array (called docs)
of objects that will get rendered as those &lt;li>s in the template:-->
ä¸Šä¼ å™¨çš„â€œæ¨¡å‹â€æ˜¯ä¸€ä¸ªç®€å•çš„æ•°ç»„ï¼ˆç§°ä¸º docsï¼‰ï¼ŒåŒ…å«å°†æ¸²æŸ“ä¸ºæ¨¡æ¿ä¸­çš„é‚£äº›
&lt;li&gt; çš„å¯¹è±¡ã€‚
</p>

<pre data-filename="app.js">
var gDriveApp = angular.module('gDriveApp', []);

gDriveApp.factory('gdocs', function() {
  var gdocs = new GDocs();
  return gdocs;
});

function DocsController($scope, $http, gdocs) {
  $scope.docs = [];

  $scope.fetchDocs = function() {
     ...
  };

  // Invoke on ctor call. Fetch docs after we have the oauth token.
  gdocs.auth(function() {
    $scope.fetchDocs();
  });

}
</pre>

<p>
<!--@Notice that <code>gdocs.auth()</code> is called
as part of the DocsController constructor.
When Angular's internals create the controller,
we're insured to have a fresh OAuth token waiting for the user.-->
æ³¨æ„ï¼Œ<code>gdocs.auth()</code> ä½œä¸º DocsController
æ„é€ å‡½æ•°çš„ä¸€éƒ¨åˆ†è°ƒç”¨ã€‚å½“ Angular
çš„å†…éƒ¨å®ç°åˆ›å»ºæ§åˆ¶å™¨åï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šå·²ç»è·å–äº†æœ€æ–°çš„ OAuth ä»¤ç‰Œç­‰å¾…ç”¨æˆ·ã€‚
</p>

<h2 id="five"><!--@Fetching data-->è·å–æ•°æ®</h2>

<p>
<!--@Template laid out.
Controller scaffolded.
OAuth token in hand.
Now what?-->
æ¨¡æ¿ç¼–å†™å®Œæˆï¼Œæ§åˆ¶å™¨æŒ‡å®šå¥½äº†ï¼ŒOAuth ä»¤ç‰Œä¹Ÿåœ¨æ‰‹ä¸­äº†ï¼Œæ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ
</p>

<p>
<!--@It's time to define the main controller method,
<code>fetchDocs()</code>.
It's the workhorse of the controller,
responsible for requesting the user's files and
filing the docs array with data from API responses.-->
ç°åœ¨åº”è¯¥å®šä¹‰æ§åˆ¶å™¨ä¸»æ–¹æ³• <code>fetchDocs()</code>
äº†ã€‚å®ƒå°†å®Œæˆæ§åˆ¶å™¨çš„å·¥ä½œï¼Œè´Ÿè´£è¯·æ±‚ç”¨æˆ·çš„æ–‡ä»¶å¹¶ç”¨ API å“åº”ä¸­çš„æ•°æ®å¡«å……
docs æ•°ç»„ã€‚
</p>

<pre data-filename="app.js">
$scope.fetchDocs = function() {
  $scope.docs = []; // First, clear out any old results

  // Response handler that doesn't cache file icons.
  var successCallback = function(resp, status, headers, config) {
    var docs = [];
    var totalEntries = resp.feed.entry.length;

    resp.feed.entry.forEach(function(entry, i) {
      var doc = {
        title: entry.title.$t,
        updatedDate: Util.formatDate(entry.updated.$t),
        updatedDateFull: entry.updated.$t,
        icon: gdocs.getLink(entry.link,
                            'http://schemas.google.com/docs/2007#icon').href,
        alternateLink: gdocs.getLink(entry.link, 'alternate').href,
        size: entry.docs$size ? '( ' + entry.docs$size.$t + ' bytes)' : null
      };

      $scope.docs.push(doc);

      // Only sort when last entry is seen.
      if (totalEntries - 1 == i) {
        $scope.docs.sort(Util.sortByDate);
      }
    });
  };

  var config = {
    params: {'alt': 'json'},
    headers: {
      'Authorization': 'Bearer ' + gdocs.accessToken,
      'GData-Version': '3.0'
    }
  };

  $http.get(gdocs.DOCLIST_FEED, config).success(successCallback);
};
</pre>

<p>
<!--@<code>fetchDocs()</code> uses Angular's <code>$http</code> service
to retrieve the main feed over XHR.
The oauth access token is included
in the <code>Authorization</code> header
along with other custom headers and parameters.-->
<code>fetchDocs()</code> ä½¿ç”¨ Angular çš„ <code>$http</code> æœåŠ¡é€šè¿‡
XHR è·å–ä¸»è¦ä¾›ç¨¿ï¼ŒOAuth è®¿é—®ä»¤ç‰ŒåŒ…å«åœ¨ <code>Authorization</code>
å¤´ä¿¡æ¯ä¸­ï¼ŒåŒæ—¶åŒ…å«å…¶ä»–è‡ªå®šä¹‰å¤´ä¿¡æ¯åŠå‚æ•°ã€‚
</p>

<p>
<!--@The <code>successCallback</code> processes the API response and
creates a new doc object for each entry in the feed. -->
<code>successCallback</code> å¤„ç† API
å“åº”å¹¶ä¸ºä¾›ç¨¿ä¸­æ¯ä¸€é¡¹åˆ›å»ºä¸€ä¸ªæ–°çš„ doc å¯¹è±¡ã€‚
</p>

<p>
<!--@If you run <code>fetchDocs()</code> right now,
everything works and the list of files shows up:-->
å¦‚æœæ‚¨ç°åœ¨è¿è¡Œ <code>fetchDocs()</code>ï¼Œä¸€åˆ‡éƒ½å°†å·¥ä½œèµ·æ¥ï¼Œå¹¶å‡ºç°æ–‡ä»¶åˆ—è¡¨ï¼š
</p>

<img src="https://developer.chrome.com/static/images/listoffiles.png"
     width="580"
     height="680"
     alt="Fetched list of files in Google Drive Uploader">

<p>
<!--@Woot!-->å“‡ï¼
</p>

<p>
<!--@Wait,...we're missing those neat file icons.
What gives?
A quick check of the console shows a bunch of CSP-related errors:-->
ç­‰ç­‰â€¦â€¦æˆ‘ä»¬å¥½åƒå°‘äº†æ•´é½çš„æ–‡ä»¶å›¾æ ‡ã€‚æ€ä¹ˆä¼šè¿™æ ·ï¼Ÿè¿…é€Ÿåœ°æ£€æŸ¥ä¸€ä¸‹æ§åˆ¶å°ï¼Œæ˜¾ç¤ºäº†å‡ ä¸ª
CSP ç›¸å…³çš„é”™è¯¯ï¼š
</p>

<img src="https://developer.chrome.com/static/images/csperrors.png"
     width="947"
     height="84"
     alt="CSP errors in developer console">

<p>
<!--@The reason is that we're trying
to set the icons <code>img.src</code> to external URLs.
This violates CSP.
For example:
<code>https://ssl.gstatic.com/docs/doclist/images/icon_10_document_list.png</code>.
To fix this,
we need to pull in these remote assets locally to the app.-->
åŸå› æ˜¯æˆ‘ä»¬å°è¯•å°†å›¾æ ‡çš„ <code>img.src</code> è®¾ç½®ä¸ºå¤–éƒ¨ URLï¼Œè¿™è¿åäº†
CSPã€‚ä¾‹å¦‚ï¼š<code>https://ssl.gstatic.com/docs/doclist/images/icon_10_document_list.png</code>ã€‚è¦ä¿®å¤è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›è¿œç¨‹èµ„æºè·å–åˆ°æœ¬åœ°ä¾›åº”ç”¨ä½¿ç”¨ã€‚
</p>

<h3 id="import"><!--@Importing remote image assets-->å¯¼å…¥è¿œç¨‹å›¾ç‰‡èµ„æº</h3>

<p>
<!--@For CSP to stop yelling at us,
we use XHR2 to "import" the file icons as Blobs,
then set the <code>img.src</code>
to a <code>blob: URL</code> created by the app.-->
ä¸ºäº†ä¸è®© CSP å¯¹æˆ‘ä»¬å¤§å«ï¼Œæˆ‘ä»¬ä½¿ç”¨ XHR2 å°†æ–‡ä»¶å›¾æ ‡â€œå¯¼å…¥â€ä¸º Blobï¼Œç„¶åè®¾ç½®
<code>img.src</code> ä¸ºåº”ç”¨åˆ›å»ºçš„ <code>blob: URL</code>ã€‚
</p>

<p>
<!--@Here's the updated <code>successCallback</code>
with the added XHR code:-->
å¦‚ä¸‹æ˜¯æ›´æ–°ååŒ…å«æ–°å¢çš„ XHR ä»£ç çš„ <code>successCallback</code>ï¼š
</p>

<pre data-filename="app.js">
var successCallback = function(resp, status, headers, config) {
  var docs = [];
  var totalEntries = resp.feed.entry.length;

  resp.feed.entry.forEach(function(entry, i) {
    var doc = {
      ...
    };

    <strong>$http.get(doc.icon, {responseType: 'blob'}).success(function(blob) {
      console.log('Fetched icon via XHR');

      blob.name = doc.iconFilename; // Add icon filename to blob.

      writeFile(blob); // Write is async, but that's ok.

      doc.icon = window.URL.createObjectURL(blob);

      $scope.docs.push(doc);

      // Only sort when last entry is seen.
      if (totalEntries - 1 == i) {
        $scope.docs.sort(Util.sortByDate);
      }
    });</strong>
  });
};
</pre>

<p>
<!--@Now that CSP is happy with us again,
we get nice file icons:-->
ç°åœ¨ CSP å¯¹æˆ‘ä»¬æ»¡æ„äº†ï¼Œæˆ‘ä»¬å°†å¾—åˆ°æ¼‚äº®çš„æ–‡ä»¶å›¾æ ‡ï¼š
</p>

<img src="https://developer.chrome.com/static/images/fileicons.png"
     width="580"
     height="680"
     alt="Google Drive Uploader with file icons">

<h2 id="six"><!--@Going offline: caching external resources-->æ”¯æŒç¦»çº¿ï¼šç¼“å­˜å¤–éƒ¨èµ„æº</h2>

<p>
<!--@The obvious optimization that needs to be made:
not make 100s of XHR requests for each file icon
on every call to <code>fetchDocs()</code>.
Verify this in the Developer Tools console
by pressing the "Refresh" button several times.
Every time, n images are fetched:-->
éœ€è¦è¿›è¡Œçš„ä¸€ä¸ªæ˜æ˜¾çš„ä¼˜åŒ–å°±æ˜¯ï¼šä¸è¦åœ¨æ¯ä¸€æ¬¡è°ƒç”¨
<code>fetchDocs()</code> æ—¶ä¸ºæ¯ä¸ªæ–‡ä»¶å›¾æ ‡å‘å‡º 100 å¤šä¸ª XHR
è¯·æ±‚ã€‚å•å‡»å‡ æ¬¡â€œåˆ·æ–°â€æŒ‰é’®ï¼Œå°±å¯ä»¥åœ¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°ä¸­éªŒè¯è¿™ä¸€ç‚¹ã€‚æ¯ä¸€æ¬¡ä¼šè·å–
n ä¸ªå›¾ç‰‡ï¼š
</p>

<img src="https://developer.chrome.com/static/images/fetchedicon.png"
     width="180"
     height="19"
     alt="Console log 65: Fetched icon via XHR">

<p>
<!--@Let's modify <code>successCallback</code>
to add a caching layer.
The additions are highlighted in bold:-->
è®©æˆ‘ä»¬ä¿®æ”¹
<code>successCallback</code>ï¼Œå¢åŠ ä¸€ä¸ªç¼“å­˜å±‚ã€‚å¢åŠ çš„éƒ¨åˆ†ä»¥ç²—ä½“é«˜äº®ï¼š
</p>

<pre data-filename="app.js">
$scope.fetchDocs = function() {
  ...

  // Response handler that caches file icons in the filesystem API.
  var successCallbackWithFsCaching = function(resp, status, headers, config) {
    var docs = [];
    var totalEntries = resp.feed.entry.length;

    resp.feed.entry.forEach(function(entry, i) {
      var doc = {
        ...
      };

      <strong>// 'https://ssl.gstatic.com/doc_icon_128.png' -> 'doc_icon_128.png'
      doc.iconFilename = doc.icon.substring(doc.icon.lastIndexOf('/') + 1);</strong>

      // If file exists, it we'll get back a FileEntry for the filesystem URL.
      // Otherwise, the error callback will fire and we need to XHR it in and
      // write it to the FS.
      <strong>var fsURL = fs.root.toURL() + FOLDERNAME + '/' + doc.iconFilename;
      window.webkitResolveLocalFileSystemURL(fsURL, function(entry) {
        doc.icon = entry.toURL(); // should be === to fsURL, but whatevs.</strong>
        
        $scope.docs.push(doc); // add doc to model.

        // Only want to sort and call $apply() when we have all entries.
        if (totalEntries - 1 == i) {
          $scope.docs.sort(Util.sortByDate);
          $scope.$apply(function($scope) {}); // Inform angular that we made changes.
        }

      <strong>}, function(e) {
        // Error: file doesn't exist yet. XHR it in and write it to the FS.
        
        $http.get(doc.icon, {responseType: 'blob'}).success(function(blob) {
          console.log('Fetched icon via XHR');

          blob.name = doc.iconFilename; // Add icon filename to blob.

          writeFile(blob); // Write is async, but that's ok.

          doc.icon = window.URL.createObjectURL(blob);

          $scope.docs.push(doc);

          // Only sort when last entry is seen.
          if (totalEntries - 1 == i) {
            $scope.docs.sort(Util.sortByDate);
          }
        });

      });</strong>
    });
  };

  var config = {
    ...
  };

  $http.get(gdocs.DOCLIST_FEED, config).success(successCallbackWithFsCaching);
};
</pre>

<p>
<!--@Notice that in the <code>webkitResolveLocalFileSystemURL()</code> callback
we're calling <code>$scope.$apply()</code>
when  the last entry is seen.
Normally calling <code>$apply()</code> isn't necessary.
Angular detects changes to data models automagically.
However in our case,
we have an addition layer of asynchronous callback
that Angular isn't aware of.
We must explicitly tell Angular when our model has been updated.-->
æ³¨æ„åœ¨ <code>webkitResolveLocalFileSystemURL()</code>
å›è°ƒå‡½æ•°ä¸­ï¼Œå½“å¾ªç¯åˆ°æœ€åä¸€é¡¹æ—¶æˆ‘ä»¬è°ƒç”¨äº† <code>$scope.$apply()</code>ã€‚é€šå¸¸
<code>$apply()</code> çš„è°ƒç”¨ä¸æ˜¯å¿…è¦çš„ï¼ŒAngular
ä¼šä»¥æŸç§æ–¹å¼è‡ªåŠ¨æ£€æµ‹æ•°æ®æ¨¡å‹çš„æ›´æ”¹ã€‚ç„¶è€Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å·²ç»å¢åŠ äº†ä¸€å±‚
Angular æ„è¯†ä¸åˆ°çš„å¼‚æ­¥å›è°ƒå‡½æ•°ï¼Œå½“æˆ‘ä»¬çš„æ•°æ®æ¨¡å‹æ›´æ–°æ—¶æˆ‘ä»¬å¿…é¡»æ˜¾å¼å‘Šè¯‰
Angularã€‚
</p>

<p>
<!--@On first run,
the icons won't be in the HTML5 Filesystem and the calls to
<code>window.webkitResolveLocalFileSystemURL()</code> will result
in its error callback being invoked.
For that case,
we can reuse the technique from before and fetch the images.
The only difference this time is that
each blob is written to the filesystem (see-->
ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œå›¾æ ‡è¿˜ä¸åœ¨ HTML5
æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œ<code>window.webkitResolveLocalFileSystemURL()</code>
çš„è°ƒç”¨å°†ä¼šå¯¼è‡´é”™è¯¯å›è°ƒå‡½æ•°çš„æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡ç”¨ä¹‹å‰çš„æŠ€æœ¯è·å–å›¾ç‰‡ã€‚è¿™ä¸€æ¬¡å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æ¯ä¸€ä¸ª Blob å°†å†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼ˆå‚è§
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/js/app.js#L27">writeFile()</a><!--@).
The console verifies this behavior:-->ï¼‰ã€‚æ§åˆ¶å°éªŒè¯äº†è¿™ä¸€è¡Œä¸ºï¼š
</p>

<img src="https://developer.chrome.com/static/images/writecompleted.png"
     width="804"
     height="42"
     alt="Console log 100: Write completed">

<p>
<!--@Upon next run (or press of the "Refresh" button),
the URL passed to <code>webkitResolveLocalFileSystemURL()</code> exists
because the file has been previously cached.
The app sets the <code>doc.icon</code>
to the file's <code>filesystem: URL</code> and
avoids making the costly XHR for the icon.-->
ä¸‹ä¸€æ¬¡è¿è¡Œæ—¶ï¼ˆæˆ–è€…æŒ‰ä¸‹â€œåˆ·æ–°â€æŒ‰é’®ï¼‰ï¼Œç”±äºæ–‡ä»¶ä¹‹å‰å·²ç»ç¼“å­˜äº†ï¼Œä¼ é€’ç»™
<code>webkitResolveLocalFileSystemURL()</code> çš„ URL å­˜åœ¨ã€‚åº”ç”¨å°†
<code>doc.icon</code> è®¾ç½®ä¸ºæ–‡ä»¶çš„ <code>filesystem:</code>
URLï¼Œä»¥å…ä¸ºäº†å›¾æ ‡å‘èµ·æ˜‚è´µçš„ XHRã€‚
</p>

<h2 id="seven"><!--@Drag and drop uploading-->é€šè¿‡æ‹–æ”¾ä¸Šä¼ </h2>

<p>
<!--@An uploader app is false advertising
if it can't upload files!-->
ä¸Šä¼ å™¨åº”ç”¨å¦‚æœä¸èƒ½ä¸Šä¼ æ–‡ä»¶çš„è¯é‚£å®ƒå°±åœ¨åšå‡å¹¿å‘Šï¼
</p>

<p>
<a href="https://github.com/GoogleChrome/chrome-app-samples/blob/master/gdrive/js/app.js#L52">app.js</a>
<!--@handles this feature by implementing a small library
around HTML5 Drag and Drop called <code>DnDFileController</code>.
It gives the ability to drag in files from the desktop
and have them uploaded to Google Drive.-->
å®ç°äº†ä¸€ä¸ªåä¸º <code>DnDFileController</code> çš„å°å‹åº“ï¼Œä½¿ç”¨ HTML5
æ‹–æ”¾æ¥å¤„ç†è¿™ä¸€ç‰¹æ€§ã€‚å®ƒæä¾›äº†ä»æ¡Œé¢æ‹–åŠ¨æ–‡ä»¶å¹¶å°†å®ƒä»¬ä¸Šä¼ åˆ°
Google äº‘ç«¯ç¡¬ç›˜çš„èƒ½åŠ›ã€‚
</p>

<p>
<!--@Simply adding this to the gdocs service does the job:-->
åªè¦å°†æ­¤åŠ å…¥ gdocs æœåŠ¡å°±å®Œæˆäº†ä»»åŠ¡ï¼š
</p>

<pre data-filename="app.js">
gDriveApp.factory('gdocs', function() {
  var gdocs = new GDocs();
  
  var dnd = new DnDFileController('body', function(files) {
    var $scope = angular.element(this).scope();
    Util.toArray(files).forEach(function(file, i) {
      gdocs.upload(file, function() {
        $scope.fetchDocs();
      });
    });
  });

  return gdocs;
});
</pre>
      </div>
    </div>
  </body>

  <div id="gc-footer">
    <button class="google-button" id="scroll-to-top">â†‘</button>
    <button class="google-button" id="send-feedback" style="display:none">Send Feedback</button>
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        è¯¥é¡µé¢ç¿»è¯‘è‡ª
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        ä¸
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>ã€‚é™¤éç‰¹åˆ«<a href="https://code.google.com/policies.html#restrictions">è¯´æ˜</a>ï¼Œè¯¥é¡µé¢çš„å†…å®¹éµå¾ª
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>ï¼Œä»£ç ç¤ºä¾‹éµå¾ª
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>ã€‚
      </p>
      <p class="crxdoczh-footer">
        <a href="https://code.google.com/p/crxdoczh/">crxdoczh é¡¹ç›®ä¸»é¡µ</a>
        <a href="https://code.google.com/p/crxdoczh/issues/entry?template=%E7%BD%91%E7%AB%99%E5%8F%8D%E9%A6%88">å‘é€åé¦ˆ</a>
        <a href="" rel="publisher">
          Google+ é¡µé¢
        </a>
        <a href="https://plus.google.com/communities/105384952265487436177">Google+ ç¤¾ç¾¤</a>
      </p>
      <script src="../../developer.chrome.com/static/js/platform_chooser.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/popup.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/prettify.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/scroll.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/sidebar.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/tabs.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++) {
            var preElement = preElements[i];
            preElement.classList.add('prettyprint');
            var datasetFilename = preElement.getAttribute('data-filename');
            if (datasetFilename) {
              var filename = document.createElement('div');
              filename.className = 'filename nocode';
              filename.textContent = datasetFilename;
              preElement.insertBefore(filename, preElement.firstChild);
            }
          }
          prettyPrint();
        })();

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25062424-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = 'https://ssl.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        window.___gcfg = {
      Â  Â  lang: 'zh-CN'
      Â  };
      Â  (function() {
      Â  Â  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      Â  Â  po.src = 'https://apis.google.com/js/plusone.js';
      Â  Â  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      Â  })();
      </script>
    </div>
  </div>
</html>
