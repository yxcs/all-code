<!DOCTYPE html>
<html>
  <head>
    <title>ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="../static/css/site.css" rel="stylesheet" type="text/css">
    <link href="../../developer.chrome.com/static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="../../developer.chrome.com/static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  </head>

  <body>


<!-- Copyright © 2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  on  12/24/13 11:31:37.<br>
<b>Address:</b> <a class="info" href="https://crxdoc-zh.appspot.com/apps/sencha_framework.html">https://crxdoc-zh.appspot.com/apps/sencha_framework.html</a><br>
<b>Title:</b> ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰ &nbsp;&bull;&nbsp; <b>Size:</b> 42516<br></div>
<!-- /Copyright © 2005. Spidersoft Ltd -->


    <div id="gc-topnav">
      <table><tr>
      <td id="chrome-logo">
        <a href="apps.html" title="Google Chrome åº”ç”¨" id="view-original">
          <img src="../../developer.chrome.com/static/images/chrome-logo.png" alt=""> chrome
        </a>
        <script type="text/javascript">
          document.getElementById('view-original').href = "https://developer.chrome.com" + location.pathname;
        </script>
        <div id="platform-chooser">
          <button id="platform-chooser-toggle" data-menu="platform-chooser-popup">
            åº”ç”¨ &#x25be;&#x202F;
          </button>
          <div id="platform-chooser-popup">
            <button class="apps" data-href="/apps/about_apps.html"><!--@apps-->åº”ç”¨</button>
            <button class="extensions" data-href="/extensions"><!--@extensions-->æ‰©å±•ç¨‹åº</button>
          </div>
        </div>ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰
      </td>
      <td>
        <ul>
          <li>
            <a href="samples.html"
               title="ç¤ºä¾‹ åº”ç”¨ï¼ˆåŒ…å«æºä»£ç ï¼‰"><!--@Samples-->ç¤ºä¾‹</a>
          </li>
          <li>
            <a href="http://groups.google.com/a/chromium.org/group/chromium-apps"
               title="Google Chrome åº”ç”¨å¼€å‘è€…è®ºå›"
               target="_blank"><!--@Group-->è®ºå›ï¼ˆè‹±æ–‡ï¼‰</a>
          </li>
          <li>
            <a href="http://stackoverflow.com/tags/google-chrome-app/info"
               title="Stack Overflow ä¸Šçš„ [google-chrome-app] æ ‡ç­¾"
               target="_blank">Stack overflow</a>
          </li>
        </ul>
      </td>
      </tr></table>
    </div>
    <div id="gc-topnav-space"></div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <g:plusone></g:plusone>
        <ul 
            class="level1 ">
        <li class="level2">
              <span class="level2">å‘ç°</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="about_apps.html" class="level3 ">ä»€ä¹ˆæ˜¯ Chrome åº”ç”¨ï¼Ÿ</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¼€å‘</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="first_app.html" class="level3 ">åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">æ•™ç¨‹</span>
                <div class="toggleIndicator level3 toggled"></div>
              </a>
            <ul toggleable
                class="level3 ">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">é€šè¿‡ä»£ç å®éªŒå®¤å­¦ä¹ </span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_codelab.html" class="level5 ">å…³äºä»£ç å®éªŒå®¤</a>
              </li><li class="level5">
                    <a href="app_codelab1_setup.html" class="level5 ">1ã€è®¾ç½®å¼€å‘ç¯å¢ƒ</a>
              </li><li class="level5">
                    <a href="app_codelab2_basic.html" class="level5 ">2ã€åˆ›å»ºåŸºæœ¬çš„åº”ç”¨</a>
              </li><li class="level5">
                    <a href="app_codelab3_mvc.html" class="level5 ">3ã€åˆ›å»º MVC</a>
              </li><li class="level5">
                    <a href="app_codelab5_data.html" class="level5 ">4ã€ä¿å­˜å’Œè·å–æ•°æ®</a>
              </li><li class="level5">
                    <a href="app_codelab6_lifecycle.html" class="level5 ">5ã€ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="app_codelab7_useridentification.html" class="level5 ">6ã€è®¿é—®ç”¨æˆ·æ•°æ®</a>
              </li><li class="level5">
                    <a href="app_codelab8_webresources.html" class="level5 ">7ã€è®¿é—®ç½‘ç»œèµ„æº</a>
              </li><li class="level5">
                    <a href="app_codelab_10_publishing.html" class="level5 ">8ã€å‘å¸ƒåº”ç”¨</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">MVC æ¶æ„ä¸æ¡†æ¶</span>
                  <div class="toggleIndicator level4 toggled"></div>
                </a>
              <ul toggleable
                  class="level4 ">
              <li class="level5">
                    <a href="app_frameworks.html" class="level5 ">å…³äº MVC æ¶æ„</a>
              </li><li class="level5">
                    <a href="angular_framework.html" class="level5 ">ç”¨ AngularJS å»ºç«‹åº”ç”¨</a>
              </li><li class="level5">
                    <a  class="level5 selected">ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨</a>
              </li>
              </ul>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">Chrome åº”ç”¨çš„æ¦‚å¿µ</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">åŸºç¡€çŸ¥è¯†</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_architecture.html" class="level5 ">åº”ç”¨çš„æ¶æ„</a>
              </li><li class="level5">
                    <a href="app_lifecycle.html" class="level5 ">åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="offline_apps.html" class="level5 ">é¦–å…ˆè€ƒè™‘ç¦»çº¿</a>
              </li><li class="level5">
                    <a href="app_external.html" class="level5 ">å¤–éƒ¨å†…å®¹</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å®‰å…¨æ€§</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="contentSecurityPolicy.html" class="level5 ">å†…å®¹å®‰å…¨ç­–ç•¥</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å°†æ‚¨çš„åº”ç”¨ä¸äº‘ç«¯ç»“åˆ</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘æ¶ˆæ¯æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="cloudMessaging.html" class="level6 ">å…³äºäº‘æ¶ˆæ¯æœåŠ¡</a>
                </li><li class="level6">
                      <a href="pushMessaging.html" class="level6 ">å®¢æˆ·ç«¯å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="gcm_server.html" class="level6 ">æœåŠ¡å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="gcm_tos.html" class="level6 ">æœåŠ¡æ¡æ¬¾</a>
                </li>
                </ul>
              </li><li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘å­˜å‚¨æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="storage.html" class="level6 ">chrome.storage</a>
                </li>
                </ul>
              </li><li class="level5">
                    <a href="app_identity.html" class="level5 ">ç”¨æˆ·è®¤è¯</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å­˜å‚¨ä¸è·å–æ•°æ®</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_storage.html" class="level5 ">å­˜å‚¨ API</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä½¿ç”¨ä½çº§ç³»ç»ŸæœåŠ¡</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="app_usb.html" class="level5 ">USB</a>
              </li><li class="level5">
                    <a href="app_serial.html" class="level5 ">ä¸²è¡Œç«¯å£</a>
              </li><li class="level5">
                    <a href="app_network.html" class="level5 ">ç½‘ç»œé€šä¿¡</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä¸ä¸»æœºå¹³å°äº¤äº’</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="desktop_notifications.html" class="level5 ">ä¸°å¯Œçš„é€šçŸ¥</a>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‘å¸ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="publish_app.html" class="level3 ">å‘å¸ƒæ‚¨çš„åº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">é€šè¿‡æ‚¨çš„åº”ç”¨è·åˆ©</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="google_wallet.html" class="level4 ">ç”¨äºæ•°å­—å•†å“çš„ Google ç”µå­é’±åŒ…</a>
            </li>
            </ul>
          </li><li class="level3">
                <a href="analytics.html" class="level3 ">Analyticsï¼ˆåˆ†æï¼‰</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‚è€ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="api_index.html" class="level3 ">Chrome å¹³å° API</a>
          </li><li class="level3">
                <a href="tags/webview.html" class="level3 ">Webview æ ‡ç­¾</a>
          </li><li class="level3">
                <a href="api_other.html" class="level3 ">ç½‘é¡µ API</a>
          </li><li class="level3">
                <a href="manifest.html" class="level3 ">æ¸…å•æ–‡ä»¶æ ¼å¼</a>
          </li><li class="level3">
                <a href="app_deprecated.html" class="level3 ">ç¦ç”¨çš„ç½‘é¡µç‰¹æ€§</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">ç¤ºä¾‹</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="samples.html" class="level3 ">ç¤ºä¾‹åº”ç”¨</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¸®åŠ©</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="faq.html" class="level3 ">å¸¸è§é—®é¢˜</a>
          </li><li class="level3">
                <a href="https://groups.google.com/a/chromium.org/forum/#!forum/chromium-apps" class="level3 ">Google ç½‘ä¸Šè®ºå›</a>
          </li><li class="level3">
                <a href="http://stackoverflow.com/questions/tagged/google-chrome-app" class="level3 ">Stack Overflow</a>
          </li>
          </ul>
        </li>
        </ul>
      </div>
      <div id="gc-pagecontent">

<div id="toc">
  <ol>
    <li >
      <a href="#first"
         data-list-item
         >åˆ›å»ºæ¸…å•æ–‡ä»¶</a>
    </li>
    <li >
      <a href="#second"
         data-list-item
         >åˆ›å»ºäº‹ä»¶é¡µé¢</a>
    </li>
    <li >
      <a href="#three"
         data-list-item
         >é€šè¿‡æ²™ç›’å±è”½åº”ç”¨çš„é€»è¾‘</a>
    </li>
    <li >
      <a href="#four"
         data-list-item
         >åœ¨æ–‡ä»¶ä¹‹é—´é€šä¿¡</a>
    </li>
    <li >
      <a href="#five"
         data-list-item
         >æœç´¢åª’ä½“æœåŠ¡å™¨</a>
      <ol>
        <li >
          <a href="#post"
             data-list-item
             >ä¼ é€’æ¶ˆæ¯</a>
        </li>
        <li >
          <a href="#call"
             data-list-item
             >è°ƒç”¨ upnpDiscover()</a>
        </li>
        <li >
          <a href="#parse"
             data-list-item
             >åˆ†æåª’ä½“æœåŠ¡å™¨æ•°æ®</a>
        </li>
        <li >
          <a href="#connect"
             data-list-item
             >è¿æ¥åˆ°åª’ä½“æœåŠ¡å™¨</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#six"
         data-list-item
         >æµè§ˆå’Œæ’­æ”¾åª’ä½“</a>
    </li>
    <li >
      <a href="#seven"
         data-list-item
         >ç¦»çº¿ä¿å­˜åª’ä½“</a>
    </li>
  </ol>
</div>

<meta name="doc-family" content="apps">
<h1><!--@Build Apps with Sencha Ext JS-->ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨</h1>

<p>
<!--@The goal of this doc is to get you started
on building Chrome Apps with the-->
è¯¥æ–‡æ¡£çš„ç›®çš„æ˜¯ä½¿æ‚¨åˆæ­¥äº†è§£å¦‚ä½•ä½¿ç”¨
<a href="http://www.sencha.com/products/extjs">Sencha Ext JS</a><!--@ framework.
To achieve this goal,
we will dive into a media player app built by Sencha.
The <a href="https://github.com/GoogleChrome/sencha-video-player-app">source code</a>
and <a href="http://senchaprosvcs.github.com/GooglePlayer/docs/output/#!/api">API Documentation</a> are available on GitHub.-->
æ¡†æ¶å»ºç«‹ Chrome åº”ç”¨ã€‚è¦å®ç°è¿™ä¸€ç›®çš„ï¼Œæˆ‘ä»¬å°†ä¼šæ·±å…¥è®¨è®ºä¸€ä¸ªé€šè¿‡ Sencha
å»ºç«‹çš„åª’ä½“æ’­æ”¾å™¨åº”ç”¨ï¼Œ<a href="https://github.com/GoogleChrome/sencha-video-player-app">æºä»£ç </a>ä¸
<a href="http://senchaprosvcs.github.com/GooglePlayer/docs/output/#!/api">API æ–‡æ¡£</a>å¯ä»¥åœ¨åœ¨
GitHub ä¸Šè®¿é—®ã€‚
</p>

<p>
<!--@This app discovers a user's available media servers,
including media devices connected to the pc and
software that manages media over the network. 
Users can browse media, play over the network,
or save offline.-->
è¯¥åº”ç”¨ç¨‹åºæœç´¢ç”¨æˆ·å¯ç”¨çš„åª’ä½“æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬è¿æ¥åˆ° PC
çš„åª’ä½“è®¾å¤‡åŠé€šè¿‡ç½‘ç»œç®¡ç†åª’ä½“çš„è½¯ä»¶ã€‚ç”¨æˆ·å¯ä»¥æµè§ˆåª’ä½“ã€é€šè¿‡ç½‘ç»œæ’­æ”¾æˆ–è€…ç¦»çº¿ä¿å­˜ã€‚
</p>

<p><!--@Here are the key things you must do
to build a media player app using Sencha Ext JS:-->
å¦‚ä¸‹æ˜¯æ‚¨ä½¿ç”¨ Sencha Ext JS å»ºç«‹åª’ä½“æ’­æ”¾å™¨åº”ç”¨æ—¶å¿…é¡»åšçš„å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š
</p>

<ul>
  <li><!--@Create manifest, <code>manifest.json</code>.-->
  åˆ›å»ºæ¸…å•æ–‡ä»¶ <code>manifest.json</code>ã€‚
  </li>
  <li><!--@Create <a href="https://crxdoc-zh.appspot.com/apps/app_lifecycle.html#eventpage">event page</a>,
    <code>background.js</code>.-->
    åˆ›å»º<a href="https://crxdoc-zh.appspot.com/apps/app_lifecycle.html#eventpage">äº‹ä»¶é¡µé¢</a>
    <code>background.js</code>ã€‚
  </li>
  <li><!--@<a href="app_external.html#sandboxing">Sandbox</a> app's logic.-->
  ç”¨<a href="https://crxdoc-zh.appspot.com/apps/app_external.html#sandboxing">æ²™ç›’</a>å±è”½åº”ç”¨çš„é€»è¾‘ã€‚
  </li>
  <li><!--@Communicate between Chrome App and sandboxed files.-->
  åœ¨ Chrome åº”ç”¨ä¸ç»è¿‡æ²™ç›’å±è”½çš„æ–‡ä»¶ä¹‹é—´é€šä¿¡ã€‚
  </li>
  <li><!--@Discover media servers.-->æœç´¢åª’ä½“æœåŠ¡å™¨ã€‚</li>
  <li><!--@Explore and play media.-->æµè§ˆä¸æ’­æ”¾åª’ä½“ã€‚</li>
  <li><!--@Save media offline.-->ç¦»çº¿ä¿å­˜åª’ä½“ã€‚</li>
</ul>

<h2 id="first"><!--@Create manifest-->åˆ›å»ºæ¸…å•æ–‡ä»¶</h2>

<p>
<!--@All Chrome Apps require a
<a href="manifest.html">manifest file</a>
which contains the information Chrome needs to launch apps.
As indicated in the manifest,
the media player app is "offline_enabled";
media assets can be saved locally,
accessed and played regardless of connectivity.-->
æ‰€æœ‰ Chrome åº”ç”¨éƒ½éœ€è¦ä¸€ä¸ªæ¸…å•æ–‡ä»¶ï¼ŒåŒ…å« Chrome
æµè§ˆå™¨æ‰§è¡Œåº”ç”¨æ—¶éœ€è¦çš„ä¿¡æ¯ã€‚å¦‚<a href="manifest.html">æ¸…å•æ–‡ä»¶</a>ä¸­æ‰€è¿°ï¼Œåª’ä½“æ’­æ”¾å™¨åº”ç”¨æ˜¯
"offline_enabled"ï¼ˆåœ¨ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿèƒ½ä½¿ç”¨ï¼‰ï¼Œåª’ä½“èµ„æºå¯ä»¥åœ¨æœ¬åœ°ä¿å­˜ã€è®¿é—®åŠæ’­æ”¾ï¼Œä¸ç®¡æœ‰æ²¡æœ‰ç½‘ç»œè¿æ¥ã€‚
</p>

<p>
<!--@The "sandbox" field is used
to sandbox the app's main logic in a unique origin.
All sandboxed content is exempt from the Chrome App
<a href="contentSecurityPolicy.html">Content Security Policy</a>,
but cannot directly access the Chrome App APIs. 
The manifest also includes the "socket" permission;
the media player app uses the <a href="https://crxdoc-zh.appspot.com/apps/socket.html">socket API</a>
to connect to a media server over the network.-->
"sandbox"
å­—æ®µç”¨æ¥å°†åº”ç”¨çš„ä¸»è¦é€»è¾‘é€šè¿‡æ²™ç›’å±è”½åœ¨ä¸€ä¸ªå”¯ä¸€çš„æ¥æºä¸­ï¼Œæ‰€æœ‰ç»è¿‡æ²™ç›’å±è”½çš„å†…å®¹ä¸å— Chrome åº”ç”¨<a href="contentSecurityPolicy.html">å†…å®¹å®‰å…¨ç­–ç•¥</a>çš„é™åˆ¶ï¼Œä½†ä¹Ÿä¸èƒ½ç›´æ¥è®¿é—® Chrome åº”ç”¨çš„
APIã€‚æ¸…å•æ–‡ä»¶è¿˜åŒ…å«äº† "socket"
æƒé™ï¼Œå› ä¸ºåª’ä½“æ’­æ”¾å™¨åº”ç”¨ä½¿ç”¨å¥—æ¥å­— API é€šè¿‡ç½‘ç»œè¿æ¥åˆ°åª’ä½“æœåŠ¡å™¨ã€‚
</p>

<pre data-filename="manifest.json">
{
    "name": "Video Player",
    "description": "Features network media discovery and playlist management",
    "version": "1.0.0",
    "manifest_version": 2,
    "offline_enabled": true,
    "app": {
        "background": {
            "scripts": [
                "background.js"
            ]
        }
    },
    ...

    "sandbox": {
        "pages": ["sandbox.html"]
    },
    "permissions": [
        "experimental",
        "http://*/*",
        "unlimitedStorage",
        {
            "socket": [
                "tcp-connect",
                "udp-send-to",
                "udp-bind"
            ]
        }
    ]
}
</pre>

<h2 id="second"><!--@Create event page-->åˆ›å»ºäº‹ä»¶é¡µé¢</h2>

<p>
<!--@All Chrome Apps require <code>background.js</code>
to launch the application.
The media player's main page, <code>index.html</code>,
opens in a window with the specified dimensions:-->
æ‰€æœ‰ Chrome åº”ç”¨éƒ½éœ€è¦ <code>background.js</code>
æ¥æ‰§è¡Œåº”ç”¨ã€‚åª’ä½“æ’­æ”¾å™¨çš„ä¸»é¡µé¢ <code>index.html</code>
å°†ä¼šåœ¨æŒ‡å®šå¤§å°çš„çª—å£ä¸­æ‰“å¼€ï¼š
</p>

<pre data-filename="background.js">
chrome.app.runtime.onLaunched.addListener(function(launchData) {
    var opt = {
        width: 1000,
        height: 700
    };

    chrome.app.window.create('index.html', opt, function (win) {
        win.launchData = launchData;
    });

});
</pre>

<h2 id="three"><!--@Sandbox app's logic-->é€šè¿‡æ²™ç›’å±è”½åº”ç”¨çš„é€»è¾‘</h2>

<p><!--@Chrome Apps run in a controlled environment
that enforces a strict <a href="contentSecurityPolicy.html">Content Security Policy (CSP)</a>.
The media player app needs some higher privileges to render the Ext JS components.
To comply with CSP and execute the app logic,
the app's main page, <code>index.html</code>, creates an iframe
that acts as a sandbox environment:-->
Chrome åº”ç”¨ç¨‹åºåœ¨ä¸€ä¸ªå—æ§åˆ¶çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œå¼ºåˆ¶å®æ–½ä¸¥æ ¼çš„<a href="contentSecurityPolicy.html"
>å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰</a>ï¼Œè€Œåª’ä½“æ’­æ”¾å™¨åº”ç”¨éœ€è¦æŸäº›æ›´é«˜çš„æƒé™æ¥æ¸²æŸ“ Ext JS
ç»„ä»¶ã€‚ä¸ºäº†éµå¾ª CSP çš„åŒæ—¶æ‰§è¡Œåº”ç”¨çš„é€»è¾‘ï¼Œåº”ç”¨çš„ä¸»é¡µé¢
<code>index.html</code> åˆ›å»ºäº†ä¸€ä¸ª iframeï¼Œä½œä¸ºä¸€ä¸ªç»è¿‡æ²™ç›’å±è”½çš„ç¯å¢ƒï¼š

<pre data-filename="index.html">
&lt;iframe id="sandbox-frame" sandbox="allow-scripts" src="sandbox.html">&lt;/iframe>
</pre>

<p><!--@The--> iframe <!--@points to-->æŒ‡å‘ <a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/sandbox.html">sandbox.html</a><!--@ which includes the files required for the Ext JS application:-->ï¼ŒåŒ…å«äº†
Ext JS åº”ç”¨éœ€è¦çš„æ–‡ä»¶ï¼š
</p>

<pre data-filename="sandbox.html">
&lt;html&gt;
&lt;head&gt;
    &lt;link rel="stylesheet" type="text/css" href="resources/css/app.css" /&gt;
    &lt;script src="sdk/ext-all-dev.js"&gt;&lt;/script&gt;
    &lt;script src="lib/ext/data/PostMessage.js"&gt;&lt;/script&gt;
    &lt;script src="lib/ChromeProxy.js"&gt;&lt;/script&gt;
    &lt;script src="app.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>
<!--@The--> <a href="http://senchaprosvcs.github.com/GooglePlayer/docs/output/source/app.html#VP-Application">app.js</a> <!--@script executes all the Ext JS code and renders the media player views.
Since this script is sandboxed, it cannot directly access the Chrome App APIs.
Communication between <code>app.js</code> and non-sandboxed files is done using the
<a href="https://developer.mozilla.org/en-US/docs/DOM/window.postMessage">HTML5 Post Message API</a>.-->
è„šæœ¬æ‰§è¡Œæ‰€æœ‰ Ext JS
ä»£ç ï¼Œå¹¶æ¸²æŸ“åª’ä½“æ’­æ”¾å™¨çš„è§†å›¾ã€‚ç”±äºè¯¥è„šæœ¬ç»è¿‡æ²™ç›’å±è”½ï¼Œå®ƒæ— æ³•ç›´æ¥è®¿é—® Chrome
åº”ç”¨çš„ APIï¼Œä½†å¯ä»¥ä½¿ç”¨
<a href="https://developer.mozilla.org/en-US/docs/DOM/window.postMessage">HTML5
æ¶ˆæ¯ä¼ é€’ API</a> å®ç° <code>app.js</code> ä¸ä¸ç»è¿‡æ²™ç›’å±è”½çš„æ–‡ä»¶é—´çš„é€šä¿¡ã€‚
</p>

<h2 id="four"><!--@Communicate between files-->åœ¨æ–‡ä»¶ä¹‹é—´é€šä¿¡</h2>

<p>
<!--@In order for the media player app to access Chrome Apps APIs,
like query the network for media servers, -->ä¸ºäº†ä½¿åª’ä½“æ’­æ”¾åº”ç”¨è®¿é—® Chrome
åº”ç”¨çš„ APIï¼Œä¾‹å¦‚æŸ¥è¯¢ç½‘ç»œä¸Šçš„åª’ä½“æœåŠ¡å™¨ï¼Œ<code>app.js</code><!--@
posts messages to -->
å‘
<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/index.js">index.js</a><!--@.
Unlike the sandboxed <code>app.js</code>,
<code>index.js</code> can directly access the Chrome Apps APIs.-->
ä¼ é€’æ¶ˆæ¯ã€‚å’Œç»è¿‡æ²™ç›’å±è”½çš„ <code>app.js</code> ä¸åŒï¼Œ<code>index.js</code>
å¯ä»¥ç›´æ¥è®¿é—® Chrome åº”ç”¨ APIã€‚
</p>

<p>
<code>index.js</code> <!--@creates the iframe:-->è·å–æ¡†æ¶ï¼š
</p>

<pre data-filename="index.js">
var iframe = document.getElementById('sandbox-frame');

iframeWindow = iframe.contentWindow;
</pre>

<p>
<!--@And listens for messages from the sandboxed files:-->
ç„¶åç›‘å¬æ¥è‡ªç»è¿‡æ²™ç›’å±è”½çš„æ–‡ä»¶çš„æ¶ˆæ¯ï¼š
</p>

<pre data-filename="index.js">
window.addEventListener('message', function(e) {
    var data= e.data,
        key = data.key;

    console.log('[index.js] Post Message received with key ' + key);

    switch (key) {
        case 'extension-baseurl':
            extensionBaseUrl(data);
            break;

        case 'upnp-discover':
            upnpDiscover(data);
            break;

        case 'upnp-browse':
            upnpBrowse(data);
            break;

        case 'play-media':
            playMedia(data);
            break;

        case 'download-media':
            downloadMedia(data);
            break;

        case 'cancel-download':
            cancelDownload(data);
            break;

        default:
            console.log('[index.js] unidentified key for Post Message: "' + key + '"');
    }
}, false);
</pre>

<p>
<!--@In the following example,
<code>app.js</code> sends a message to <code>index.js</code>
requesting the key 'extension-baseurl':-->
åœ¨ä»¥ä¸‹ä¾‹å­ä¸­ï¼Œ<code>app.js</code> å‘ <code>index.js</code>
å‘é€æ¶ˆæ¯ï¼Œè¯·æ±‚é”®ä¸º 'extension-baseurl'ï¼š
</p>

<pre data-filename="app.js">
Ext.data.PostMessage.request({
    key: 'extension-baseurl',
    success: function(data) {
        //...
    }
});
</pre>

<p>
<code>index.js</code> <!--@receives the request, assigns the result,
and replies by sending the Base URL back:-->
æ¥æ”¶è¯·æ±‚ï¼Œè®¾ç½®ç»“æœï¼Œé€šè¿‡å‘å›åŸºæœ¬ URL çš„æ–¹å¼å›å¤ï¼š
</p>

<pre data-filename="index.js">
function extensionBaseUrl(data) {
    data.result = chrome.extension.getURL('/');
    iframeWindow.postMessage(data, '*');
}
</pre>

<h2 id="five"><!--@Discover media servers-->æœç´¢åª’ä½“æœåŠ¡å™¨</h2>

<p>
<!--@There's a lot that goes into discovering media servers.
At a high level, the discovery workflow is initiated
by a user action to search for available media servers.
The <a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/app/controller/MediaServers.js">MediaServer controller</a>
posts a message to <code>index.js</code>;
<code>index.js</code> listens for this message and when received,
calls <a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/lib/Upnp.js">Upnp.js</a>.-->
æœç´¢åª’ä½“æœåŠ¡å™¨æ¶‰åŠåˆ°è®¸å¤šç»†èŠ‚ã€‚ä»è¾ƒé«˜çš„å±‚æ¬¡æ¥çœ‹ï¼Œæœç´¢çš„å·¥ä½œæµç¨‹ç”±ç”¨æˆ·æœç´¢å¯ç”¨åª’ä½“æœåŠ¡å™¨çš„æ“ä½œå‘èµ·ï¼Œ<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/app/controller/MediaServers.js"
>åª’ä½“æœåŠ¡å™¨æ§åˆ¶å™¨</a>å‘
<code>index.js</code> å‘é€æ¶ˆæ¯ï¼Œ<code>index.js</code> ç›‘å¬è¯¥æ¶ˆæ¯ï¼Œæ”¶åˆ°æ—¶è°ƒç”¨
<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/lib/Upnp.js">Upnp.js</a>ã€‚
</p>

<p>
<!--@The <code>Upnp library</code> uses the Chrome App
<a href="app_network.html">socket API</a>
to connect the media player app with any discovered media servers
and receive media data from the media server.
<code>Upnp.js</code> also uses
<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/lib/soapclient.js">soapclient.js</a>
to parse the media server data.
The remainder of this section describes this workflow in more detail.-->
<code>Upnp</code> åº“ä½¿ç”¨ Chrome åº”ç”¨çš„<a href="app_network.html">å¥—æ¥å­—
API</a>
å°†æ‰€æœ‰å‘ç°çš„åª’ä½“æœåŠ¡å™¨è¿æ¥åˆ°åª’ä½“æ’­æ”¾å™¨åº”ç”¨ï¼Œå¹¶ä»åª’ä½“æœåŠ¡å™¨æ¥æ”¶åª’ä½“æ•°æ®ã€‚<code>Upnp.js</code>
è¿˜ä½¿ç”¨ <a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/lib/soapclient.js">soapclient.js</a>
åˆ†æåª’ä½“æœåŠ¡å™¨çš„æ•°æ®ã€‚è¿™ä¸€èŠ‚å‰©ä¸‹çš„å†…å®¹æ›´è¯¦ç»†åœ°æè¿°è¿™ä¸€å·¥ä½œæµç¨‹ã€‚
</p>

<h3 id="post"><!--@Post message-->ä¼ é€’æ¶ˆæ¯</h3>

<p>
<!--@When a user clicks the Media Servers button in the center of the media player app,
<code>MediaServers.js</code> calls <code>discoverServers()</code>.
This function first checks for any outstanding discovery requests,
and if true, aborts them so the new request can be initiated.
Next, the controller posts a message to <code>index.js</code>
with a key upnp-discovery, and two callback listeners:-->
å½“ç”¨æˆ·å•å‡»åª’ä½“æ’­æ”¾å™¨åº”ç”¨ä¸­å¤®çš„åª’ä½“æœåŠ¡å™¨æŒ‰é’®æ—¶ï¼Œ<code>MediaServers</code>
è°ƒç”¨ <code>discoverServers()</code>ã€‚è¯¥å‡½æ•°é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ­£åœ¨è¿›è¡Œçš„å‘ç°è¯·æ±‚ï¼Œå¦‚æœæœ‰çš„è¯ç»ˆæ­¢å®ƒä»¬ä»¥ä¾¿å‘èµ·æ–°çš„è¯·æ±‚ã€‚æ¥ç€ï¼Œæ§åˆ¶å™¨å‘
<code>index.js</code> ä¼ é€’æ¶ˆæ¯ï¼Œé”®ä¸º
upnp-discoveryï¼Œå¹¶åŒ…å«ä¸¤ä¸ªå›è°ƒå‡½æ•°ç›‘å¬å™¨ï¼š
</p>

<pre data-filename="MediaServers.js">
me.activeDiscoverRequest = Ext.data.PostMessage.request({
    key: 'upnp-discover',
    success: function(data) {
        var items = [];
        delete me.activeDiscoverRequest;

        if (serversGraph.isDestroyed) {
            return;
        }

        mainBtn.isLoading = false;
        mainBtn.removeCls('pop-in');
        mainBtn.setIconCls('ico-server');
        mainBtn.setText('Media Servers');

        //add servers
        Ext.each(data, function(server) {
            var icon,
                urlBase = server.urlBase;

            if (urlBase) {
                if (urlBase.substr(urlBase.length-1, 1) === '/'){
                        urlBase = urlBase.substr(0, urlBase.length-1);
                }
            }

            if (server.icons &amp;&amp; server.icons.length) {
                if (server.icons[1]) {
                    icon = server.icons[1].url;
                }
                else {
                    icon = server.icons[0].url;
                }

                icon = urlBase + icon;
            }

            items.push({
                itemId: server.id,
                text: server.friendlyName,
                icon: icon,
                data: server
            });
        });

        ...
    },
    failure: function() {
        delete me.activeDiscoverRequest;
                
        if (serversGraph.isDestroyed) {
            return;
        }
                
        mainBtn.isLoading = false;
        mainBtn.removeCls('pop-in');
        mainBtn.setIconCls('ico-error');
        mainBtn.setText('Error...click to retry');
    }
});
</pre>

<h3 id="call"><!--@Call-->è°ƒç”¨ upnpDiscover()</h3>

<p>
<code>index.js</code> <!--@listens
for the 'upnp-discover' message from <code>app.js</code>
and responds by calling <code>upnpDiscover()</code>.
When a media server is discovered,
<code>index.js</code> extracts the media server domain from the parameters,
saves the server locally, formats the media server data,
and pushes the data to the <code>MediaServer</code> controller.-->
ç›‘å¬æ¥è‡ª <code>app.js</code> çš„ 'upnp-discover' æ¶ˆæ¯ï¼Œå¹¶é€šè¿‡è°ƒç”¨
<code>upnpDiscover()</code> å“åº”ã€‚å½“å‘ç°æŸä¸ªåª’ä½“æœåŠ¡å™¨æ—¶ï¼Œ<code>index.js</code>
ä»å‚æ•°ä¸­æå–åª’ä½“æœåŠ¡å™¨çš„åŸŸåï¼Œåœ¨æœ¬åœ°ä¿å­˜æœåŠ¡å™¨ï¼Œæ ¼å¼åŒ–åª’ä½“æœåŠ¡å™¨æ•°æ®ï¼Œå¹¶å°†æ•°æ®ä¼ é€’ç»™ <code>MediaServer</code> æ§åˆ¶å™¨ã€‚
</p>

<h3 id="parse"><!--@Parse media server data-->åˆ†æåª’ä½“æœåŠ¡å™¨æ•°æ®</h3>

<p>
<!--@When <code>Upnp.js</code> discovers a new media server,
it then retrieves a description of the device
and sends a Soaprequest to browse and parse the media server data;
<code>soapclient.js</code> parses the media elements by tag name
into a document.-->
å½“ <code>Upnp.js</code> å‘ç°æ–°çš„åª’ä½“æœåŠ¡å™¨æ—¶ï¼Œå®ƒä¼šè·å–è®¾å¤‡çš„æè¿°ï¼Œå¹¶å‘å‡º
Soaprequest æµè§ˆå¹¶åˆ†æåª’ä½“æœåŠ¡å™¨æ•°æ®ï¼Œ<code>soapclient.js</code>
é€šè¿‡æ–‡æ¡£ä¸­çš„æ ‡ç­¾åç§°åˆ†æåª’ä½“å…ƒç´ ã€‚
</p>

<h3 id="connect"><!--@Connect to media server-->è¿æ¥åˆ°åª’ä½“æœåŠ¡å™¨</h3>

<p>
<code>Upnp.js</code> <!--@connects to discovered media servers
and receives media data using the Chrome Apps socket API:-->
è¿æ¥åˆ°å‘ç°çš„åª’ä½“æœåŠ¡å™¨ï¼Œå¹¶ä½¿ç”¨ Chrome åº”ç”¨çš„å¥—æ¥å­— API æ¥æ”¶åª’ä½“æ•°æ®ï¼š
</p>

<pre data-filename="Upnp.js">
socket.create("udp", {}, function(info) {
    var socketId = info.socketId;
        
    //bind locally
    socket.bind(socketId, "0.0.0.0", 0, function(info) {
            
        //pack upnp message
        var message = String.toBuffer(UPNP_MESSAGE);
            
        //broadcast to upnp
        socket.sendTo(socketId, message, UPNP_ADDRESS, UPNP_PORT, function(info) {
                
            // Wait 1 second
            setTimeout(function() {
                    
                //receive
                socket.recvFrom(socketId, function(info) {

                    //unpack message
                    var data        = String.fromBuffer(info.data),
                        servers     = [],
                        locationReg = /^location:/i;
                            
                    //extract location info
                    if (data) {
                        data = data.split("\r\n");
                            
                        data.forEach(function(value) {
                            if (locationReg.test(value)){
                                servers.push(value.replace(locationReg, "").trim());
                            }
                        });
                    }
                            
                    //success
                    callback(servers);
                });
                    
            }, 1000);
        });
    });
});
</pre>


<h2 id="six"><!--@Explore and play media-->æµè§ˆå’Œæ’­æ”¾åª’ä½“</h2>

<p>
<!--@The-->
<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/app/controller/MediaExplorer.js">MediaExplorer <!--@controller-->æ§åˆ¶å™¨</a><!--@
lists all the media files inside a media server folder
and is responsible for updating the breadcrumb navigation
in the media player app window.
When a user selects a media file,
the controller posts a message to <code>index.js</code>
with the 'play-media' key:-->åˆ—å‡ºåª’ä½“æœåŠ¡å™¨æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰åª’ä½“æ–‡ä»¶ï¼Œå¹¶è´Ÿè´£æ›´æ–°åª’ä½“æ’­æ”¾å™¨åº”ç”¨çª—å£ä¸­çš„é¢åŒ…å±‘å¯¼èˆªã€‚å½“ç”¨æˆ·é€‰ä¸­åª’ä½“æ–‡ä»¶æ—¶ï¼Œæ§åˆ¶å™¨å‘
<code>index.js</code> ä¼ é€’æ¶ˆæ¯ï¼Œé”®ä¸º 'play-media'ã€‚
</p>

<pre data-filename="MediaExplorer.js">
onFileDblClick: function(explorer, record) {
    var serverPanel, node,
        type    = record.get('type'),
        url     = record.get('url'),
        name    = record.get('name'),
        serverId= record.get('serverId');
            
    if (type === 'audio' || type === 'video') {
        Ext.data.PostMessage.request({
            key     : 'play-media',
            params  : {
                url: url,
                name: name,
                type: type
            }
        });
    }
},
</pre>

<p>
<code>index.js</code> <!--@listens for this post message and
responds by calling <code>playMedia()</code>:-->
ç›‘å¬ä¼ é€’è¿‡æ¥çš„è¯¥æ¶ˆæ¯ï¼Œå¹¶é€šè¿‡è°ƒç”¨ <code>playMedia()</code> å“åº”ã€‚
</p>

<pre data-filename="index.js">
function playMedia(data) {
    var type        = data.params.type,
        url         = data.params.url,
        playerCt    = document.getElementById('player-ct'),
        audioBody   = document.getElementById('audio-body'),
        videoBody   = document.getElementById('video-body'),
        mediaEl     = playerCt.getElementsByTagName(type)[0],
        mediaBody   = type === 'video' ? videoBody : audioBody,
        isLocal     = false;

    //save data
    filePlaying = {
        url : url,
        type: type,
        name: data.params.name
    };

    //hide body els
    audioBody.style.display = 'none';
    videoBody.style.display = 'none';

    var animEnd = function(e) {

        //show body el
        mediaBody.style.display = '';

        //play media
        mediaEl.play();

        //clear listeners
        playerCt.removeEventListener( 'webkitTransitionEnd', animEnd, false );
        animEnd = null;
    };

    //load media
    mediaEl.src = url;
    mediaEl.load();

    //animate in player
    playerCt.addEventListener( 'webkitTransitionEnd', animEnd, false );
    playerCt.style.webkitTransform = "translateY(0)";

    //reply postmessage
    data.result = true;
    sendMessage(data);
}
</pre>

<h2 id="seven"><!--@Save media offline-->ç¦»çº¿ä¿å­˜åª’ä½“</h2>

<p>
<!--@Most of the hard work to save media offline is done by the-->
ç¦»çº¿ä¿å­˜åª’ä½“çš„å¤§éƒ¨åˆ†ç¹é‡ä»»åŠ¡ç”±
<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/lib/filer.js">filer.js <!--@library-->åº“</a><!--@.
You can read more this library in-->æ¥å®ç°ï¼Œæ‚¨å¯ä»¥åœ¨
<a href="http://ericbidelman.tumblr.com/post/14866798359/introducing-filer-js"><!--@Introducing -->filer.js ç®€ä»‹</a><!--@.-->ä¸­äº†è§£æœ‰å…³è¯¥åº“çš„æ›´å¤šå†…å®¹ã€‚
</p>

<p>
<!--@The process kicks off when a user selects one or more files
and initiates the 'Take offline' action.
The
-->å½“ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œ
'Take offline'ï¼ˆç¦»çº¿ä¿å­˜ï¼‰æ“ä½œæ—¶ï¼Œå°†å¼€å§‹è¿™ä¸€è¿‡ç¨‹ã€‚<a href="https://github.com/GoogleChrome/sencha-video-player-app/blob/master/app/controller/MediaExplorer.js">MediaExplorer <!--@controller-->æ§åˆ¶å™¨</a><!--@ posts a message to <code>index.js</code>
with a key 'download-media'; <code>index.js</code> listens for this message
and calls the <code>downloadMedia()</code> function
to initiate the download process:-->å‘ <code>index.js</code> ä¼ é€’æ¶ˆæ¯ï¼Œé”®ä¸º
'download-media'ã€‚<code>index.js</code> ç›‘å¬è¯¥æ¶ˆæ¯å¹¶è°ƒç”¨
<code>downloadMedia()</code> å‡½æ•°å¼€å§‹ä¸‹è½½è¿‡ç¨‹ï¼š
</p>

<pre data-filename="index.js">
function downloadMedia(data) {
        DownloadProcess.run(data.params.files, function() {
            data.result = true;
            sendMessage(data);
        });
    }
</pre>

<p>
<!--@The <code>DownloadProcess</code> utility method creates an xhr request
to get data from the media server and waits for completion status.
This initiates the onload callback which checks the received content
and saves the data locally using the <code>filer.js</code> function:-->
<code>DownloadProcess</code> å®ç”¨æ–¹æ³•åˆ›å»º XHR
è¯·æ±‚ä»åª’ä½“æœåŠ¡å™¨è·å–æ•°æ®ï¼Œå¹¶ç­‰å¾…å®ŒæˆçŠ¶æ€ã€‚ç„¶åè°ƒç”¨ onload
å›è°ƒå‡½æ•°ï¼Œæ£€æŸ¥æ¥æ”¶åˆ°çš„å†…å®¹å¹¶ä½¿ç”¨ <code>filer.js</code> å‡½æ•°åœ¨æœ¬åœ°ä¿å­˜æ•°æ®ï¼š
</p>

<pre data-filename="filer.js">
filer.write(
    saveUrl,
    {
        data: Util.arrayBufferToBlob(fileArrayBuf),
        type: contentType
    },
    function(fileEntry, fileWriter) {

        console.log('file saved!');

        //increment downloaded
        me.completedFiles++;

        //if reached the end, finalize the process
        if (me.completedFiles === me.totalFiles) {

            sendMessage({
                key             : 'download-progresss',
                totalFiles      : me.totalFiles,
                completedFiles  : me.completedFiles
            });

            me.completedFiles = me.totalFiles = me.percentage = me.downloadedFiles = 0;
            delete me.percentages;

            //reload local
            loadLocalFiles(callback);
        }
    },
    function(e) {
        console.log(e);
    }
);
</pre>

<p>
<!--@When the download process is finished,
<code>MediaExplorer</code> updates the media file list and the media player tree panel.-->
ä¸‹è½½è¿‡ç¨‹å®Œæˆåï¼Œ<code>MediaExplorer</code>
æ›´æ–°åª’ä½“æ–‡ä»¶åˆ—è¡¨ä»¥åŠåª’ä½“æ’­æ”¾å™¨çš„æ ‘çª—æ ¼ã€‚
</p>
      </div>
    </div>
  </body>

  <div id="gc-footer">
    <button class="google-button" id="scroll-to-top">â†‘</button>
    <button class="google-button" id="send-feedback" style="display:none">Send Feedback</button>
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        è¯¥é¡µé¢ç¿»è¯‘è‡ª
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        ä¸
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>ã€‚é™¤éç‰¹åˆ«<a href="https://code.google.com/policies.html#restrictions">è¯´æ˜</a>ï¼Œè¯¥é¡µé¢çš„å†…å®¹éµå¾ª
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>ï¼Œä»£ç ç¤ºä¾‹éµå¾ª
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>ã€‚
      </p>
      <p class="crxdoczh-footer">
        <a href="https://code.google.com/p/crxdoczh/">crxdoczh é¡¹ç›®ä¸»é¡µ</a>
        <a href="https://code.google.com/p/crxdoczh/issues/entry?template=%E7%BD%91%E7%AB%99%E5%8F%8D%E9%A6%88">å‘é€åé¦ˆ</a>
        <a href="" rel="publisher">
          Google+ é¡µé¢
        </a>
        <a href="https://plus.google.com/communities/105384952265487436177">Google+ ç¤¾ç¾¤</a>
      </p>
      <script src="../../developer.chrome.com/static/js/platform_chooser.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/popup.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/prettify.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/scroll.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/sidebar.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/tabs.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++) {
            var preElement = preElements[i];
            preElement.classList.add('prettyprint');
            var datasetFilename = preElement.getAttribute('data-filename');
            if (datasetFilename) {
              var filename = document.createElement('div');
              filename.className = 'filename nocode';
              filename.textContent = datasetFilename;
              preElement.insertBefore(filename, preElement.firstChild);
            }
          }
          prettyPrint();
        })();

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25062424-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = 'https://ssl.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        window.___gcfg = {
      Â  Â  lang: 'zh-CN'
      Â  };
      Â  (function() {
      Â  Â  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      Â  Â  po.src = 'https://apis.google.com/js/plusone.js';
      Â  Â  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      Â  })();
      </script>
    </div>
  </div>
</html>
