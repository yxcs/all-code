<!DOCTYPE html>
<html>
  <head>
    <title>ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="/static/css/site.css" rel="stylesheet" type="text/css">
    <link href="https://developer.chrome.com/static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="https://developer.chrome.com/static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  </head>

  <body>


<!-- Copyright © 2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  on  12/24/13 11:31:37.<br>
<b>Address:</b> <a class="info" href="https://crxdoc-zh.appspot.com/apps/app_codelab6_lifecycle.html">https://crxdoc-zh.appspot.com/apps/app_codelab6_lifecycle.html</a><br>
<b>Title:</b> ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ - Google Chrome åº”ç”¨å¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰ &nbsp;&bull;&nbsp; <b>Size:</b> 32681<br></div>
<!-- /Copyright © 2005. Spidersoft Ltd -->


    <div id="gc-topnav">
      <table><tr>
      <td id="chrome-logo">
        <a href="/apps/" title="Google Chrome åº”ç”¨" id="view-original">
          <img src="https://developer.chrome.com/static/images/chrome-logo.png" alt=""> chrome
        </a>
        <script type="text/javascript">
          document.getElementById('view-original').href = "https://developer.chrome.com" + location.pathname;
        </script>
        <div id="platform-chooser">
          <button id="platform-chooser-toggle" data-menu="platform-chooser-popup">
            åº”ç”¨ &#x25be;&#x202F;
          </button>
          <div id="platform-chooser-popup">
            <button class="apps" data-href="/apps/about_apps.html"><!--@apps-->åº”ç”¨</button>
            <button class="extensions" data-href="/extensions"><!--@extensions-->æ‰©å±•ç¨‹åº</button>
          </div>
        </div>ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰
      </td>
      <td>
        <ul>
          <li>
            <a href="/apps/samples.html"
               title="ç¤ºä¾‹ åº”ç”¨ï¼ˆåŒ…å«æºä»£ç ï¼‰"><!--@Samples-->ç¤ºä¾‹</a>
          </li>
          <li>
            <a href="http://groups.google.com/a/chromium.org/group/chromium-apps"
               title="Google Chrome åº”ç”¨å¼€å‘è€…è®ºå›"
               target="_blank"><!--@Group-->è®ºå›ï¼ˆè‹±æ–‡ï¼‰</a>
          </li>
          <li>
            <a href="http://stackoverflow.com/tags/google-chrome-app/info"
               title="Stack Overflow ä¸Šçš„ [google-chrome-app] æ ‡ç­¾"
               target="_blank">Stack overflow</a>
          </li>
        </ul>
      </td>
      </tr></table>
    </div>
    <div id="gc-topnav-space"></div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <g:plusone></g:plusone>
        <ul 
            class="level1 ">
        <li class="level2">
              <span class="level2">å‘ç°</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/about_apps.html" class="level3 ">ä»€ä¹ˆæ˜¯ Chrome åº”ç”¨ï¼Ÿ</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¼€å‘</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/first_app.html" class="level3 ">åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">æ•™ç¨‹</span>
                <div class="toggleIndicator level3 toggled"></div>
              </a>
            <ul toggleable
                class="level3 ">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">é€šè¿‡ä»£ç å®éªŒå®¤å­¦ä¹ </span>
                  <div class="toggleIndicator level4 toggled"></div>
                </a>
              <ul toggleable
                  class="level4 ">
              <li class="level5">
                    <a href="/apps/app_codelab.html" class="level5 ">å…³äºä»£ç å®éªŒå®¤</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab1_setup.html" class="level5 ">1ã€è®¾ç½®å¼€å‘ç¯å¢ƒ</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab2_basic.html" class="level5 ">2ã€åˆ›å»ºåŸºæœ¬çš„åº”ç”¨</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab3_mvc.html" class="level5 ">3ã€åˆ›å»º MVC</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab5_data.html" class="level5 ">4ã€ä¿å­˜å’Œè·å–æ•°æ®</a>
              </li><li class="level5">
                    <a  class="level5 selected">5ã€ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab7_useridentification.html" class="level5 ">6ã€è®¿é—®ç”¨æˆ·æ•°æ®</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab8_webresources.html" class="level5 ">7ã€è®¿é—®ç½‘ç»œèµ„æº</a>
              </li><li class="level5">
                    <a href="/apps/app_codelab_10_publishing.html" class="level5 ">8ã€å‘å¸ƒåº”ç”¨</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">MVC æ¶æ„ä¸æ¡†æ¶</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/app_frameworks.html" class="level5 ">å…³äº MVC æ¶æ„</a>
              </li><li class="level5">
                    <a href="/apps/angular_framework.html" class="level5 ">ç”¨ AngularJS å»ºç«‹åº”ç”¨</a>
              </li><li class="level5">
                    <a href="/apps/sencha_framework.html" class="level5 ">ç”¨ Sencha Ext JS å»ºç«‹åº”ç”¨</a>
              </li>
              </ul>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">Chrome åº”ç”¨çš„æ¦‚å¿µ</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                <a class="button level4">
                  <span class="level4">åŸºç¡€çŸ¥è¯†</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/app_architecture.html" class="level5 ">åº”ç”¨çš„æ¶æ„</a>
              </li><li class="level5">
                    <a href="/apps/app_lifecycle.html" class="level5 ">åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a>
              </li><li class="level5">
                    <a href="/apps/offline_apps.html" class="level5 ">é¦–å…ˆè€ƒè™‘ç¦»çº¿</a>
              </li><li class="level5">
                    <a href="/apps/app_external.html" class="level5 ">å¤–éƒ¨å†…å®¹</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å®‰å…¨æ€§</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/contentSecurityPolicy.html" class="level5 ">å†…å®¹å®‰å…¨ç­–ç•¥</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å°†æ‚¨çš„åº”ç”¨ä¸äº‘ç«¯ç»“åˆ</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘æ¶ˆæ¯æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="/apps/cloudMessaging.html" class="level6 ">å…³äºäº‘æ¶ˆæ¯æœåŠ¡</a>
                </li><li class="level6">
                      <a href="/apps/pushMessaging.html" class="level6 ">å®¢æˆ·ç«¯å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="/apps/gcm_server.html" class="level6 ">æœåŠ¡å‚è€ƒ</a>
                </li><li class="level6">
                      <a href="/apps/gcm_tos.html" class="level6 ">æœåŠ¡æ¡æ¬¾</a>
                </li>
                </ul>
              </li><li class="level5">
                  <a class="button level5">
                    <span class="level5">äº‘å­˜å‚¨æœåŠ¡</span>
                    <div class="toggleIndicator level5"></div>
                  </a>
                <ul toggleable
                    class="level5 hidden">
                <li class="level6">
                      <a href="/apps/storage.html" class="level6 ">chrome.storage</a>
                </li>
                </ul>
              </li><li class="level5">
                    <a href="/apps/app_identity.html" class="level5 ">ç”¨æˆ·è®¤è¯</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">å­˜å‚¨ä¸è·å–æ•°æ®</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/app_storage.html" class="level5 ">å­˜å‚¨ API</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä½¿ç”¨ä½çº§ç³»ç»ŸæœåŠ¡</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/app_usb.html" class="level5 ">USB</a>
              </li><li class="level5">
                    <a href="/apps/app_serial.html" class="level5 ">ä¸²è¡Œç«¯å£</a>
              </li><li class="level5">
                    <a href="/apps/app_network.html" class="level5 ">ç½‘ç»œé€šä¿¡</a>
              </li>
              </ul>
            </li><li class="level4">
                <a class="button level4">
                  <span class="level4">ä¸ä¸»æœºå¹³å°äº¤äº’</span>
                  <div class="toggleIndicator level4"></div>
                </a>
              <ul toggleable
                  class="level4 hidden">
              <li class="level5">
                    <a href="/apps/desktop_notifications.html" class="level5 ">ä¸°å¯Œçš„é€šçŸ¥</a>
              </li>
              </ul>
            </li>
            </ul>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‘å¸ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/publish_app.html" class="level3 ">å‘å¸ƒæ‚¨çš„åº”ç”¨</a>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">é€šè¿‡æ‚¨çš„åº”ç”¨è·åˆ©</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="/apps/google_wallet.html" class="level4 ">ç”¨äºæ•°å­—å•†å“çš„ Google ç”µå­é’±åŒ…</a>
            </li>
            </ul>
          </li><li class="level3">
                <a href="/apps/analytics.html" class="level3 ">Analyticsï¼ˆåˆ†æï¼‰</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‚è€ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/api_index.html" class="level3 ">Chrome å¹³å° API</a>
          </li><li class="level3">
                <a href="/apps/tags/webview.html" class="level3 ">Webview æ ‡ç­¾</a>
          </li><li class="level3">
                <a href="/apps/api_other.html" class="level3 ">ç½‘é¡µ API</a>
          </li><li class="level3">
                <a href="/apps/manifest.html" class="level3 ">æ¸…å•æ–‡ä»¶æ ¼å¼</a>
          </li><li class="level3">
                <a href="/apps/app_deprecated.html" class="level3 ">ç¦ç”¨çš„ç½‘é¡µç‰¹æ€§</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">ç¤ºä¾‹</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/samples.html" class="level3 ">ç¤ºä¾‹åº”ç”¨</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å¸®åŠ©</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="/apps/faq.html" class="level3 ">å¸¸è§é—®é¢˜</a>
          </li><li class="level3">
                <a href="https://groups.google.com/a/chromium.org/forum/#!forum/chromium-apps" class="level3 ">Google ç½‘ä¸Šè®ºå›</a>
          </li><li class="level3">
                <a href="http://stackoverflow.com/questions/tagged/google-chrome-app" class="level3 ">Stack Overflow</a>
          </li>
          </ul>
        </li>
        </ul>
      </div>
      <div id="gc-pagecontent">

<div id="toc">
  <ol>
    <li >
      <a href="#the_event_page"
         data-list-item
         >äº‹ä»¶é¡µé¢</a>
    </li>
    <li >
      <a href="#the_onlaunched"
         data-list-item
         >onLaunched äº‹ä»¶</a>
      <ol>
        <li >
          <a href="#windows_with_ids"
             data-list-item
             >æŒ‡å®šäº†æ ‡è¯†ç¬¦çš„çª—å£</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#the_onrestarted_event"
         data-list-item
         >onRestarted äº‹ä»¶</a>
      <ol>
        <li >
          <a href="#event-page"
             data-list-item
             >æ›´æ–°äº‹ä»¶é¡µé¢</a>
        </li>
        <li >
          <a href="#controller"
             data-list-item
             >æ›´æ–°æ§åˆ¶å™¨</a>
        </li>
        <li >
          <a href="#results"
             data-list-item
             >æ£€æŸ¥ç»“æœ</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#takeaways_"
         data-list-item
         >æ›´å¤šä¿¡æ¯</a>
    </li>
    <li >
      <a href="#you_should_also_read"
         data-list-item
         >æ‚¨è¿˜åº”è¯¥é˜…è¯»</a>
    </li>
    <li >
      <a href="#what_39_s_next_"
         data-list-item
         >æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ</a>
    </li>
  </ol>
</div>

<h1 id="lab_6_lifecycle"><!--@Manage App Lifecycle-->ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</h1>

<p><!--@Like everything in this world, apps have a lifecycle.  They are installed, launched, restarted, suspended when the system needs to free up resources and uninstalled.  This lab will show you the basics of the Chrome app lifecycle and how its heart, the event page (aka background script), is used.-->
ä¸ä¸–ç•Œä¸Šçš„æ‰€æœ‰äº‹ç‰©ä¸€æ ·ï¼Œåº”ç”¨ä¹Ÿæœ‰ç”Ÿå‘½å‘¨æœŸã€‚å®ƒä»¬ä¼šå®‰è£…ã€è¿è¡Œã€é‡æ–°å¯åŠ¨ï¼Œåœ¨ç³»ç»Ÿéœ€è¦é‡Šæ”¾èµ„æºæ—¶ä¼šæš‚åœï¼Œè¿˜ä¼šè¢«å¸è½½ã€‚è¯¥å®éªŒå°†å‘æ‚¨å±•ç¤º
Chrome åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠå®ƒçš„æ ¸å¿ƒâ€”â€”äº‹ä»¶é¡µé¢ï¼ˆå³åå°è„šæœ¬ï¼‰æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚
</p>

<h2 id="the_event_page"><!--@The event page-->äº‹ä»¶é¡µé¢</h2>

<p><!--@The event page is one of the most important pieces of a Chrome app. It&#39;s responsible for what gets launched, when, and how.
For example, if your app is an instant messenger, you might want your event page to only show a UI when there is a new notification.-->
äº‹ä»¶é¡µé¢æ˜¯ Chrome åº”ç”¨æœ€é‡è¦çš„éƒ¨åˆ†ä¹‹ä¸€ï¼Œå®ƒè´Ÿè´£ç¡®å®šè¿è¡Œçš„å†…å®¹ã€æ—¶é—´ä¸æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨æ˜¯ä¸€ä¸ªå³æ—¶é€šä¿¡å·¥å…·ï¼Œæ‚¨å¯èƒ½å¸Œæœ›æ‚¨çš„äº‹ä»¶é¡µé¢åœ¨æœ‰æ–°æ¶ˆæ¯æ—¶æ‰æ˜¾ç¤ºç”¨æˆ·ç•Œé¢ã€‚
</p>

<p><!--@For simpler apps, the event page listens to the app lifecycle events and reacts appropriately.
There are two important lifecycle events, <a href="app.runtime.html#event-onLaunched">app.runtime.onLaunched</a> and <a href="app.runtime.html#event-onRestarted">app.runtime.onRestarted</a>.-->
å¯¹äºè¾ƒå°çš„åº”ç”¨ï¼Œäº‹ä»¶é¡µé¢ç›‘å¬åº”ç”¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œå¹¶ä½œå‡ºåˆç†çš„ååº”ã€‚æœ‰ä¸¤ä¸ªé‡è¦çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼ŒåŒ…æ‹¬
<a href="app.runtime.html#event-onLaunched">app.runtime.onLaunched</a> å’Œ <a href="app.runtime.html#event-onRestarted">app.runtime.onRestarted</a>ã€‚
</p>

<h2 id="the_onlaunched"><!--@The -->onLaunched <!--@event-->äº‹ä»¶</h2>
<p><!--@The --><a href="app.runtime.html#event-onLaunched">app.runtime.onLaunched</a> <!--@event is the most important event.
It fires when the user clicks on your app&#39;s icon with the intent of launching it.
For most simpler apps,
the event page will listen for this event and open a window when it fires.
See
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/main.js">AngularJS main.js</a> or
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/main.js">JavaScript main.js</a>
for the most common usage.-->
äº‹ä»¶æ˜¯æœ€é‡è¦çš„äº‹ä»¶ï¼Œå½“ç”¨æˆ·ä¸ºäº†æ‰§è¡Œè€Œå•å‡»æ‚¨çš„åº”ç”¨å›¾æ ‡æ—¶äº§ç”Ÿã€‚å¯¹äºå¤§å¤šæ•°è¾ƒç®€å•çš„åº”ç”¨æ¥è¯´ï¼Œäº‹ä»¶é¡µé¢åº”è¯¥ç›‘å¬è¯¥äº‹ä»¶å¹¶åœ¨å®ƒäº§ç”Ÿæ—¶æ‰“å¼€ä¸€ä¸ªçª—å£ã€‚æœ‰å…³è¿™ä¸€å¸¸è§ç”¨æ³•ï¼Œè¯·å‚è§æˆ‘ä»¬çš„
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/main.js">AngularJS main.js</a> <!--@or-->æˆ–
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/main.js">JavaScript main.js</a>ã€‚
</p>

<h3 id="windows_with_ids"><!--@Windows with IDs-->æŒ‡å®šäº†æ ‡è¯†ç¬¦çš„çª—å£</h3>

<p><!--@The <a href="app.window.html#method-create">app.window.create</a> method can associate an ID to the window being opened. Currently, the most interesting use for this is to restore a window&#39;s width, height and location and its associated Developer Tools window, if opened, when the app is launched. -->
<a href="app.window.html#method-create">app.window.create</a> æ–¹æ³•å¯ä»¥å°†æ ‡è¯†ç¬¦å’Œæ‰“å¼€çš„çª—å£å…³è”ã€‚ç›®å‰ï¼Œæœ€æœ‰æ„æ€çš„ç”¨é€”æ˜¯åœ¨åº”ç”¨æ‰§è¡Œæ—¶æ¢å¤çª—å£çš„å®½åº¦ã€é«˜åº¦å’Œä½ç½®ï¼Œä»¥åŠä¸ä¹‹å…³è”çš„å¼€å‘è€…å·¥å…·çª—å£ï¼ˆå¦‚æœæ‰“å¼€çš„è¯ï¼‰ã€‚
</p>

<p><!--@Execute your app as it is now, move and resize the window,
close and restart it.
The app will reopen in the original location, right?
Now add a property <code>id</code> to the event page,
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/main.js">AngularJS main.js</a> or
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/main.js">JavaScript main.js</a>,
reload the app and test again:-->
æ‰§è¡Œæ‚¨ç°åœ¨çš„åº”ç”¨ï¼Œç§»åŠ¨å¹¶è°ƒæ•´çª—å£çš„å¤§å°ï¼Œå…³é—­ååœ¨é‡æ–°å¯åŠ¨ï¼Œåº”ç”¨è¿˜æ˜¯ä¼šåœ¨åŸæ¥çš„ä½ç½®é‡æ–°æ‰“å¼€ï¼Œæ˜¯å—ï¼Ÿç°åœ¨åœ¨
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/main.js">AngularJS main.js</a> æˆ–
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/main.js">JavaScript main.js</a>
ä¸­æ·»åŠ ä¸€ä¸ª <code>id</code> å±æ€§ï¼Œé‡æ–°åŠ è½½åº”ç”¨å¹¶å†æ¬¡æµ‹è¯•ï¼š
</p>

<pre data-filename="main.js">
chrome.app.runtime.onLaunched.addListener(function() {
    chrome.app.window.create(&#39;index.html&#39;,
      {id: &#39;mainwindow&#39;, bounds: {width: 500, height: 309} });
  });
</pre>

<!--@<p>If your application requires, you can open more than one window.</p>-->
<p>å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºéœ€è¦çš„è¯ï¼Œæ‚¨å¯ä»¥æ‰“å¼€ä¸€ä¸ªä»¥ä¸Šçš„çª—å£ã€‚</p>

<h2 id="the_onrestarted_event"><!--@The onRestarted event-->onRestarted äº‹ä»¶</h2>

<!--@<p>The <a href="app.runtime.html#event-onRestarted">app.runtime.onRestarted</a> event is not as essential as <code>onLaunched</code>,
but it might be relevant to certain types of apps.
This event is executed when the app is restarted, for example,
when Chrome quits, restarts, and the app is launched again.
You can use this event to restore a transient state. </p>-->
<p><a href="app.runtime.html#event-onRestarted">app.runtime.onRestarted</a> äº‹ä»¶ä¸åƒ <code>onLaunched</code>
é‚£æ ·é‡è¦ï¼Œä½†æ˜¯å®ƒå¯èƒ½å’ŒæŸäº›ç±»å‹çš„åº”ç”¨ç›¸å…³ã€‚å½“åº”ç”¨é‡æ–°å¯åŠ¨æ—¶ï¼Œä¾‹å¦‚å½“ Chrome
æµè§ˆå™¨é€€å‡ºã€é‡æ–°å¯åŠ¨ï¼Œå†æ¬¡è¿è¡Œåº”ç”¨æ—¶ï¼Œå°†ä¼šæ‰§è¡Œè¯¥äº‹ä»¶ã€‚æ‚¨å¯ä»¥åˆ©ç”¨è¯¥äº‹ä»¶æ¢å¤ä¸´æ—¶çš„çŠ¶æ€ã€‚</p>

<!--@<p>For example, if your app has a form with several fields,
you won&#39;t always want to save the partial form while the user is typing.
If the user quits the app on purpose, she might not be interested keeping the partial data.
If the Chrome runtime restarted for some reason other than by a user&#39;s intention,
the user will want that data when the app is restarted.</p>-->
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨æœ‰ä¸€ä¸ªè¡¨å•ï¼ŒåŒ…å«å¤šä¸ªå­—æ®µï¼Œæ‚¨ä¸ä¼šåœ¨ç”¨æˆ·è¾“å…¥æ—¶å°±ä¿å­˜éƒ¨åˆ†çš„è¡¨å•ã€‚å¦‚æœç”¨æˆ·ç‰¹æ„é€€å‡ºæ‚¨çš„åº”ç”¨ï¼Œä»–ä»¬ä¸ä¸€å®šå¸Œæœ›ä¿ç•™è¿™éƒ¨åˆ†æ•°æ®ã€‚å¦‚æœ
Chrome è¿è¡Œæ—¶ç¯å¢ƒç”±äºç”¨æˆ·æ„å›¾ä»¥å¤–çš„åŸå› é‡æ–°å¯åŠ¨ï¼Œåœ¨åº”ç”¨é‡æ–°å¯åŠ¨æ—¶ç”¨æˆ·å¯èƒ½è¿˜éœ€è¦è¿™äº›æ•°æ®ã€‚</p>

<!--@<p>Let&#39;s change our code to save the Todo input field in <a href="storage.html">storage</a> as the user types,
only restoring it if the <code>onRestarted</code> event is triggered.</p>-->
<p>è®©æˆ‘ä»¬æ›´æ”¹æˆ‘ä»¬çš„ä»£ç ï¼Œå°†å¾…åŠäº‹é¡¹è¾“å…¥å­—æ®µä¿å­˜åœ¨ <a href="storage.html">storage</a>
ä¸­ï¼Œåªæœ‰åœ¨ <code>onRestarted</code> äº‹ä»¶è§¦å‘æ—¶æ‰æ¢å¤å®ƒã€‚</p>

<p class="note"><b><!--@Note:-->æ³¨æ„ï¼š</b><!--@
We learned about <code>chrome.storage.sync</code> before, but
<a href="storage.html#using-sync">chrome.storage.local</a>
wasn&#39;t mentioned until now.
Both have exactly the same syntax,
but the semantics of <code>chrome.storage.local</code> is, as the name says, completely local.
There&#39;s no attempt to synchronize or to save the data in the cloud.-->æˆ‘ä»¬ä¹‹å‰å­¦ä¹ äº†
<code>chrome.storage.sync</code>ï¼Œä½†æ˜¯ç›´åˆ°ç°åœ¨æ‰æåˆ°äº†
<a href="storage.html#using-sync">chrome.storage.local</a>ã€‚å®ƒä»¬æœ‰å®Œå…¨ç›¸åŒçš„è¯­æ³•ï¼Œä½†æ˜¯æ­£å¦‚å®ƒçš„åç§°æ‰€è¿°ï¼Œ<code>chrome.storage.local</code>
çš„å«ä¹‰å®Œå…¨æ˜¯æœ¬åœ°çš„ï¼Œè€Œä¸ä¼šå°è¯•åŒæ­¥æˆ–è€…å°†æ•°æ®ä¿å­˜åˆ°äº‘ç«¯ã€‚
</p>

<h3 id="event-page"><!--@Update event page-->æ›´æ–°äº‹ä»¶é¡µé¢</h3>

<p><!--@Update the event page to include the-->
æ›´æ–°äº‹ä»¶é¡µé¢ï¼ŒåŒ…å«
<code>onLaunched</code> <!--@and-->å’Œ <code>onRestarted</code> <!--@events.
Events are handled the same in-->
äº‹ä»¶ã€‚åœ¨
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/main.js">AngularJS main.js</a> <!--@and-->ä¸­
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/main.js">JavaScript main.js</a><!--@:-->
å¤„ç†äº‹ä»¶çš„æ–¹å¼ç›¸åŒï¼š
</p>

<pre data-filename="main.js">
chrome.app.runtime.onLaunched.addListener(function() {
  // normal launch initiated by the user, let&#39;s start clean.
  // note that this is not related to the persistent state, which is
  // appropriately handled in the window code.
  runApp(false);
});

chrome.app.runtime.onRestarted.addListener(function() {
  // if restarted, try to get the transient saved state
  runApp(true);
});

function runApp(readInitialState) {
  chrome.app.window.create(&#39;index.html&#39;,
    {id: &#39;mainwindow&#39;, bounds: {width: 500, height: 309} },
    // the create callback gets a reference to the AppWindow obj 
    function(win) {
      // when the callback is executed, the DOM is loaded but no script was
      // loaded yet. So, let&#39;s attach to the load event.
      win.contentWindow.addEventListener(&#39;load&#39;, function() {
        if (readInitialState) {
          win.contentWindow.setInitialState();
        } else {
          win.contentWindow.clearInitialState();
        }
      });
    });
}
</pre>

<h3 id="controller"><!--@Update controller-->æ›´æ–°æ§åˆ¶å™¨</h3>

<p><!--@Add to existing-->æ·»åŠ åˆ°ç°æœ‰çš„
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/angularjs/controller.js">AngularJS controller.js</a> <!--@or-->æˆ–
<a href="https://github.com/GoogleChrome/chrome-app-codelab/blob/master/lab6_lifecycle/javascript/controller.js">JavaScript controller.js</a><!--@:-->ï¼š
</p>

<tabs data-group="source">

  <header tabindex="0" data-value="angular">Angular</header>
  <header tabindex="0" data-value="js">JavaScript</header>
  
  <content>
    <pre data-filename="controller.js">
var newTodoInput = null;

var clearInitialState = function() {
  chrome.storage.local.set({&#39;newtodo&#39;: null});
}

var setInitialState = function() {
  chrome.storage.local.get(&#39;newtodo&#39;, function(data) {
    if (newTodoInput &amp;&amp; data &amp;&amp; data.newtodo) {
      newTodoInput.value = data.newtodo;
      newTodoInput.focus();
    }
  });
}

window.addEventListener(&#39;load&#39;, function() {
  var saveTransientState = function() {
    chrome.storage.local.set({&#39;newtodo&#39;: newTodoInput.value});
  };
  newTodoInput = document.querySelector(&#39;input[type=&quot;text&quot;]&#39;);
  newTodoInput.addEventListener(&#39;keypress&#39; , function() {
    saveTransientState();<br>
  })
})
    </pre>
  </content>
  <content>
    <pre data-filename="controller.js">
  var newTodoInput = document.querySelector('input[type="text"]');
 
  window.clearInitialState = function() {
    chrome.storage.local.set({'newtodo': null});
  }
   
  window.setInitialState = function() {
    chrome.storage.local.get('newtodo', function(data) {
      if (newTodoInput && data && data.newtodo) {
        newTodoInput.value = data.newtodo;
        newTodoInput.focus();
      }
    });
  };
     
  var saveTransientState = function() {
    chrome.storage.local.set({'newtodo': newTodoInput.value});
  };

  newTodoInput.addEventListener('keypress' , function() {
    saveTransientState();    
  })
    </pre>

</tabs>

<h3 id="results"><!--@Check the results-->æ£€æŸ¥ç»“æœ</h3>

<p><!--@Save the changes by reloading the app:
open the app, right-click and select Reload.-->
é‡æ–°åŠ è½½åº”ç”¨ï¼Œæ£€æŸ¥ç»“æœï¼šæ‰“å¼€åº”ç”¨ï¼Œå•å‡»å³é”®å¹¶é€‰æ‹©â€œé‡æ–°åŠ è½½åº”ç”¨â€ã€‚
</p>

<p><!--@If Chrome and the app shuts down for any reason (other than a user-gesture),
the <code>onRestarted</code> event is fired.
Any text entered in the input field (but not yet saved as a Todo item)
will reappear when Chrome and the app are reopened.-->
å¦‚æœ Chrome æµè§ˆå™¨å’Œåº”ç”¨ç”±äºä»»ä½•åŸå› ï¼ˆè€Œä¸æ˜¯ç”¨æˆ·æ“ä½œï¼‰å…³é—­ï¼Œåˆ™ä¼šäº§ç”Ÿ
<code>onRestarted</code> äº‹ä»¶ï¼Œè¾“å…¥å­—æ®µä¸­é”®å…¥çš„æ–‡æœ¬ï¼ˆä½†æ˜¯è¿˜æ²¡æœ‰ä¿å­˜ä¸ºå¾…åŠäº‹é¡¹ï¼‰ä¼šåœ¨
Chrome æµè§ˆå™¨å’Œåº”ç”¨é‡æ–°æ‰“å¼€æ—¶å†æ¬¡å‡ºç°ã€‚
</p>

<p><!--@If you get stuck and want to see the app in action,
go to-->å¦‚æœæ‚¨é‡åˆ°äº†å›°éš¾ï¼Œå¸Œæœ›ç«‹åˆ»çœ‹åˆ°åº”ç”¨ï¼Œè¯·è¿›å…¥
<code>chrome://extensions</code><!--@,
load the unpacked-->ï¼Œè½½å…¥æœªæ‰“åŒ…çš„
<a href="https://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab6_lifecycle/angularjs">AngularJS <!--@app-->åº”ç”¨</a> <!--@or-->æˆ–
<a href="https://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab6_lifecycle/javascript">JavaScript <!--@app-->åº”ç”¨</a><!--@,
and launch the app from a new tab.-->ï¼Œå¹¶ä»æ–°æ ‡ç­¾é¡µä¸­è¿è¡Œåº”ç”¨ã€‚</p>

<h2 id="takeaways_"><!--@Takeaways-->æ›´å¤šä¿¡æ¯</h2>

<ul>
<li><!--@The event page may continue to run even when your windows are closed;
you can move logic that is shared amoung windows to the event page.-->
å³ä½¿å½“æ‚¨çš„çª—å£éƒ½å…³é—­åï¼Œäº‹ä»¶é¡µé¢ä¹Ÿæœ‰å¯èƒ½ç»§ç»­è¿è¡Œã€‚æ‚¨å¯ä»¥å°†æ‰€æœ‰çª—å£é—´å…±äº«çš„é€»è¾‘ç§»åŠ¨è‡³äº‹ä»¶é¡µé¢</li>
</ul>

<h2 id="you_should_also_read"><!--@You should also read-->æ‚¨è¿˜åº”è¯¥é˜…è¯»</h2>

<p><a href="app_lifecycle.html"><!--@Manage App Lifecycle-->ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</a><!--@ tutorial-->æ•™ç¨‹</p>

<h2 id="what_39_s_next_"><!--@What's next?-->æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ</h2>

<p><!--@In-->åœ¨ <a href="app_codelab7_useridentification.html">6 - <!--@Access User's Data-->è®¿é—®ç”¨æˆ·æ•°æ®</a><!--@,
you will learn how to identify users and use OAuth2.0 to access Google and other third party services.-->ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•è®¤è¯ç”¨æˆ·ä»¥åŠå¦‚ä½•ä½¿ç”¨ OAuth2.0
è®¿é—® Google å’Œå…¶ä»–ç¬¬ä¸‰æ–¹æœåŠ¡ã€‚
</p>

<p class="note"><b><!--@Note:-->æ³¨æ„ï¼š</b><!--@
The next chapter covers a still experimental API.
If you don't want to play with experimental APIs, feel free to skip it - the
rest of the codelab is independent from it.-->ä¸‹ä¸€ç« æ¶‰åŠåˆ°çš„ API
ä»ç„¶æ˜¯å®éªŒæ€§çš„ï¼Œå¦‚æœæ‚¨ä¸æƒ³å°è¯•å®éªŒæ€§ APIï¼Œæ‚¨å¯ä»¥è·³è¿‡ï¼Œä»£ç å®éªŒå®¤çš„å‰©ä½™éƒ¨åˆ†ä¸ä¾èµ–å®ƒã€‚
</p>
      </div>
    </div>
  </body>

  <div id="gc-footer">
    <button class="google-button" id="scroll-to-top">â†‘</button>
    <button class="google-button" id="send-feedback" style="display:none">Send Feedback</button>
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        è¯¥é¡µé¢ç¿»è¯‘è‡ª
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        ä¸
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>ã€‚é™¤éç‰¹åˆ«<a href="https://code.google.com/policies.html#restrictions">è¯´æ˜</a>ï¼Œè¯¥é¡µé¢çš„å†…å®¹éµå¾ª
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>ï¼Œä»£ç ç¤ºä¾‹éµå¾ª
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>ã€‚
      </p>
      <p class="crxdoczh-footer">
        <a href="https://code.google.com/p/crxdoczh/">crxdoczh é¡¹ç›®ä¸»é¡µ</a>
        <a href="https://code.google.com/p/crxdoczh/issues/entry?template=%E7%BD%91%E7%AB%99%E5%8F%8D%E9%A6%88">å‘é€åé¦ˆ</a>
        <a href="https:////plus.google.com/112419687097816423998?prsrc=3" rel="publisher">
          Google+ é¡µé¢
        </a>
        <a href="https://plus.google.com/communities/105384952265487436177">Google+ ç¤¾ç¾¤</a>
      </p>
      <script src="https://developer.chrome.com/static/js/platform_chooser.js" type="text/javascript"></script>
      <script src="https://developer.chrome.com/static/js/popup.js" type="text/javascript"></script>
      <script src="https://developer.chrome.com/static/js/prettify.js" type="text/javascript"></script>
      <script src="https://developer.chrome.com/static/js/scroll.js" type="text/javascript"></script>
      <script src="https://developer.chrome.com/static/js/sidebar.js" type="text/javascript"></script>
      <script src="https://developer.chrome.com/static/js/tabs.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++) {
            var preElement = preElements[i];
            preElement.classList.add('prettyprint');
            var datasetFilename = preElement.getAttribute('data-filename');
            if (datasetFilename) {
              var filename = document.createElement('div');
              filename.className = 'filename nocode';
              filename.textContent = datasetFilename;
              preElement.insertBefore(filename, preElement.firstChild);
            }
          }
          prettyPrint();
        })();

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25062424-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = 'https://ssl.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        window.___gcfg = {
      Â  Â  lang: 'zh-CN'
      Â  };
      Â  (function() {
      Â  Â  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      Â  Â  po.src = 'https://apis.google.com/js/plusone.js';
      Â  Â  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      Â  })();
      </script>
    </div>
  </div>
</html>
