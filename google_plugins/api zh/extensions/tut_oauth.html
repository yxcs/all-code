<!DOCTYPE html>
<html>
  <head>
    <title>æ•™ç¨‹ï¼šOAuth - Google Chrome æ‰©å±•ç¨‹åºå¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="../static/css/site.css" rel="stylesheet" type="text/css">
    <link href="../../developer.chrome.com/static/css/print.css" rel="stylesheet" type="text/css" media="print">
    <link href="../../developer.chrome.com/static/css/prettify.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  </head>

  <body>


<!-- Copyright © 2005. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.0.3.1030</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  on  12/24/13 11:31:36.<br>
<b>Address:</b> <a class="info" href="https://crxdoc-zh.appspot.com/extensions/tut_oauth.html">https://crxdoc-zh.appspot.com/extensions/tut_oauth.html</a><br>
<b>Title:</b> æ•™ç¨‹ï¼šOAuth - Google Chrome æ‰©å±•ç¨‹åºå¼€å‘æ–‡æ¡£ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰ &nbsp;&bull;&nbsp; <b>Size:</b> 30061<br></div>
<!-- /Copyright © 2005. Spidersoft Ltd -->


    <div id="gc-topnav">
      <table><tr>
      <td id="chrome-logo">
        <a href="extensions.html" title="Google Chrome æ‰©å±•ç¨‹åº" id="view-original">
          <img src="../../developer.chrome.com/static/images/chrome-logo.png" alt=""> chrome
        </a>
        <script type="text/javascript">
          document.getElementById('view-original').href = "https://developer.chrome.com" + location.pathname;
        </script>
        <div id="platform-chooser">
          <button id="platform-chooser-toggle" data-menu="platform-chooser-popup">
            æ‰©å±•ç¨‹åº &#x25be;&#x202F;
          </button>
          <div id="platform-chooser-popup">
            <button class="apps" data-href="/apps/about_apps.html"><!--@apps-->åº”ç”¨</button>
            <button class="extensions" data-href="/extensions"><!--@extensions-->æ‰©å±•ç¨‹åº</button>
          </div>
        </div>ï¼ˆéå®˜æ–¹ä¸­æ–‡ç‰ˆï¼‰
      </td>
      <td>
        <ul>
          <li>
            <a href="samples.html"
               title="ç¤ºä¾‹ æ‰©å±•ç¨‹åºï¼ˆåŒ…å«æºä»£ç ï¼‰"><!--@Samples-->ç¤ºä¾‹</a>
          </li>
          <li>
            <a href="http://groups.google.com/a/chromium.org/group/chromium-extensions"
               title="Google Chrome æ‰©å±•ç¨‹åºå¼€å‘è€…è®ºå›"
               target="_blank"><!--@Group-->è®ºå›ï¼ˆè‹±æ–‡ï¼‰</a>
          </li>
          <li>
            <a href="http://stackoverflow.com/tags/google-chrome-extension/info"
               title="Stack Overflow ä¸Šçš„ [google-chrome-extension] æ ‡ç­¾"
               target="_blank">Stack overflow</a>
          </li>
        </ul>
      </td>
      </tr></table>
    </div>
    <div id="gc-topnav-space"></div>
    <div id="gc-container">
      <div id="gc-sidebar">
        <g:plusone></g:plusone>
        <ul 
            class="level1 ">
        <li class="level2">
              <a href="getstarted.html" class="level2 ">å…¥é—¨</a>
        </li><li class="level2">
              <a href="overview.html" class="level2 ">æ¦‚è¿°</a>
        </li><li class="level2">
              <a href="whats_new.html" class="level2 ">æ–°å¢åŠŸèƒ½</a>
        </li><li class="level2">
              <a href="devguide.html" class="level2 ">å¼€å‘è€…æŒ‡å—</a>
          <ul 
              class="level2 ">
          <li class="level3">
              <a class="button level3">
                <span class="level3">æµè§ˆå™¨ç”¨æˆ·ç•Œé¢</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="browserAction.html" class="level4 ">æµè§ˆå™¨æŒ‰é’®</a>
            </li><li class="level4">
                  <a href="contextMenus.html" class="level4 ">å³é”®èœå•</a>
            </li><li class="level4">
                  <a href="desktop_notifications.html" class="level4 ">æ¡Œé¢é€šçŸ¥</a>
            </li><li class="level4">
                  <a href="omnibox.html" class="level4 ">å¤šåŠŸèƒ½æ¡†</a>
            </li><li class="level4">
                  <a href="options.html" class="level4 ">é€‰é¡¹é¡µé¢</a>
            </li><li class="level4">
                  <a href="override.html" class="level4 ">æ›¿ä»£é¡µé¢</a>
            </li><li class="level4">
                  <a href="pageAction.html" class="level4 ">é¡µé¢æŒ‰é’®</a>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">æµè§ˆå™¨äº¤äº’</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="bookmarks.html" class="level4 ">ä¹¦ç­¾</a>
            </li><li class="level4">
                  <a href="cookies.html" class="level4 ">Cookie</a>
            </li><li class="level4">
                  <a href="devtools.html" class="level4 ">æ‰©å±•å¼€å‘è€…å·¥å…·</a>
            </li><li class="level4">
                  <a href="events.html" class="level4 ">äº‹ä»¶</a>
            </li><li class="level4">
                  <a href="history.html" class="level4 ">å†å²è®°å½•</a>
            </li><li class="level4">
                  <a href="management.html" class="level4 ">ç®¡ç†</a>
            </li><li class="level4">
                  <a href="tabs.html" class="level4 ">æ ‡ç­¾é¡µ</a>
            </li><li class="level4">
                  <a href="windows.html" class="level4 ">çª—å£</a>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">å®ç°</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="a11y.html" class="level4 ">è¾…åŠ©åŠŸèƒ½</a>
            </li><li class="level4">
                  <a href="event_pages.html" class="level4 ">äº‹ä»¶é¡µé¢</a>
            </li><li class="level4">
                  <a href="contentSecurityPolicy.html" class="level4 ">å†…å®¹å®‰å…¨ç­–ç•¥</a>
            </li><li class="level4">
                  <a href="content_scripts.html" class="level4 ">å†…å®¹è„šæœ¬</a>
            </li><li class="level4">
                  <a href="xhr.html" class="level4 ">è·¨ç«™ XHR</a>
            </li><li class="level4">
                  <a href="i18n.html" class="level4 ">å›½é™…åŒ–æ”¯æŒ</a>
            </li><li class="level4">
                  <a href="messaging.html" class="level4 ">æ¶ˆæ¯ä¼ é€’</a>
            </li><li class="level4">
                  <a href="permissions.html" class="level4 ">å¯é€‰æƒé™</a>
            </li><li class="level4">
                  <a href="npapi.html" class="level4 ">NPAPI æ’ä»¶</a>
            </li>
            </ul>
          </li><li class="level3">
              <a class="button level3">
                <span class="level3">å®Œæˆ</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="hosting.html" class="level4 ">æ‰˜ç®¡</a>
            </li><li class="level4">
                  <a href="external_extensions.html" class="level4 ">å…¶ä»–å‘å¸ƒé€‰é¡¹</a>
            </li>
            </ul>
          </li>
          </ul>
        </li><li class="level2">
              <a href="tutorials.html" class="level2 ">æ•™ç¨‹</a>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="tut_migration_to_manifest_v2.html" class="level3 ">æ¸…å•æ–‡ä»¶ç‰ˆæœ¬ 2</a>
          </li><li class="level3">
                <a href="tut_debugging.html" class="level3 ">è°ƒè¯•</a>
          </li><li class="level3">
                <a href="tut_analytics.html" class="level3 ">Google Analyticsï¼ˆåˆ†æï¼‰</a>
          </li><li class="level3">
                <a  class="level3 selected">OAuth</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">å‚è€ƒ</span>
          <ul 
              class="level2 ">
          <li class="level3">
              <a class="button level3">
                <span class="level3">æ ¼å¼</span>
                <div class="toggleIndicator level3"></div>
              </a>
            <ul toggleable
                class="level3 hidden">
            <li class="level4">
                  <a href="manifest.html" class="level4 ">æ¸…å•æ–‡ä»¶</a>
            </li><li class="level4">
                  <a href="match_patterns.html" class="level4 ">åŒ¹é…è¡¨è¾¾å¼</a>
            </li>
            </ul>
          </li><li class="level3">
                <a href="permission_warnings.html" class="level3 ">æƒé™è­¦å‘Š</a>
          </li><li class="level3">
                <a href="api_index.html" class="level3 ">chrome.* API</a>
          </li><li class="level3">
                <a href="api_other.html" class="level3 ">å…¶ä»– API</a>
          </li>
          </ul>
        </li><li class="level2">
              <span class="level2">æ›´å¤š</span>
          <ul 
              class="level2 ">
          <li class="level3">
                <a href="faq.html" class="level3 ">å¸¸è§é—®é¢˜</a>
          </li><li class="level3">
                <a href="http://code.google.com/chrome/webstore/docs/index.html" class="level3 ">Chrome ç½‘ä¸Šåº”ç”¨åº—</a>
          </li><li class="level3">
                <a href="http://code.google.com/chrome/apps/docs/developers_guide.html" class="level3 ">æ‰˜ç®¡åº”ç”¨</a>
          </li><li class="level3">
                <a href="themes.html" class="level3 ">ä¸»é¢˜èƒŒæ™¯</a>
          </li>
          </ul>
        </li>
        </ul>
      </div>
      <div id="gc-pagecontent">

<div id="toc">
  <ol>
    <li >
      <a href="#requirements"
         data-list-item
         >è¦æ±‚</a>
    </li>
    <li >
      <a href="#getting-started"
         data-list-item
         >å…¥é—¨</a>
    </li>
    <li >
      <a href="#oauth-dance"
         data-list-item
         >æ‰©å±•ç¨‹åºä¸­çš„ OAuth è®¤è¯</a>
      <ol>
        <li >
          <a href="#set-code"
             data-list-item
             >è®¾ç½®ä»£ç </a>
        </li>
        <li >
          <a href="#request-token"
             data-list-item
             >è·å–å’Œè®¤è¯è¯·æ±‚ä»¤ç‰Œ</a>
        </li>
        <li >
          <a href="#signed-requests"
             data-list-item
             >å‘é€å·²ç­¾åçš„ API è¯·æ±‚</a>
        </li>
      </ol>
    </li>
    <li >
      <a href="#sample-code"
         data-list-item
         >ç¤ºä¾‹ä»£ç </a>
    </li>
  </ol>
</div>

<h1><!--@Tutorial: -->æ•™ç¨‹ï¼šOAuth</h1>


<p>
<a href="http://oauth.net/">OAuth</a> <!--@is an open protocol that aims to standardize the way desktop and web applications access a user's private data. OAuth provides a mechanism for users to grant access to private data without sharing their private credentials (username/password). Many sites have started enabling APIs to use OAuth because of its security and standard set of libraries.-->
æ˜¯ä¸€ç§å¼€æ”¾çš„åè®®ï¼Œæ—¨åœ¨æ ‡å‡†åŒ–æ¡Œé¢ä¸ç½‘ä¸Šåº”ç”¨ç¨‹åºè®¿é—®ç”¨æˆ·ä¸ªäººæ•°æ®çš„æ–¹å¼ã€‚OAuth
æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œè®©ç”¨æˆ·æˆæƒè®¿é—®ç§æœ‰æ•°æ®ï¼Œè€Œä¸ç”¨å…±äº«å®ƒä»¬çš„ç§æœ‰å‡­æ®ï¼ˆç”¨æˆ·å/å¯†ç ï¼‰ã€‚ç”±äºå®ƒçš„å®‰å…¨æ€§ä»¥åŠå­˜åœ¨ä¸€ç»„æ ‡å‡†åº“ï¼Œè®¸å¤šç½‘ç«™å·²ç»å¼€å§‹å¯ç”¨
API ä½¿ç”¨ OAuthã€‚
</p>
<p>
<!--@This tutorial will walk you through the necessary steps for creating a Google Chrome Extension that uses OAuth to access an API. It leverages a library that you can reuse in your extensions.-->
è¿™ä¸€æ•™ç¨‹å°†ä¼šå¼•å¯¼æ‚¨äº†è§£åˆ›å»ºä½¿ç”¨ OAuth è®¿é—®æŸä¸ª API çš„ Google Chrome
æµè§ˆå™¨æ‰©å±•ç¨‹åºçš„å¿…è¦æ­¥éª¤ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ‚¨å¯ä»¥åœ¨è‡ªå·±çš„æ‰©å±•ç¨‹åºä¸­é‡ç”¨çš„åº“ã€‚
</p>
<p>
<!--@This tutorial uses the <a href="http://code.google.com/apis/documents/">Google Documents List Data API</a> as an example OAuth-enabled API endpoint.-->
è¿™ä¸€æ•™ç¨‹ä½¿ç”¨
<a href="https://developers.google.com/google-apps/documents-list/">Google æ–‡æ¡£åˆ—è¡¨æ•°æ® API</a>
ä½œä¸ºæ”¯æŒ OAuth çš„ API ç«¯ç‚¹çš„ä¾‹å­ã€‚
</p>

<h2 id="requirements"><!--@Requirements-->è¦æ±‚</h2>

<p>
<!--@This tutorial expects that you have some experience writing extensions for Google Chrome and some familiarity with the <a href="http://code.google.com/apis/accounts/docs/OAuth.html">3-legged OAuth</a> flow. Although you donâ€™t need a background in the <a href="http://code.google.com/apis/documents/">Google Documents List Data API</a> (or the other <a href="http://code.google.com/apis/gdata/">Google Data APIs</a> for that matter), having a understanding of the protocol may be helpful.-->
è¿™ä¸€æ•™ç¨‹è¦æ±‚æ‚¨å…·æœ‰ç¼–å†™ Google Chrome
æµè§ˆå™¨æ‰©å±•ç¨‹åºçš„ä¸€äº›ç»éªŒï¼Œå¹¶ä¸”è¦æ±‚æ‚¨å¯¹<a
href="https://developers.google.com/accounts/docs/OAuth">ä¸‰æ–¹
OAuth æµç¨‹</a>æœ‰ä¸€å®šçš„ç†Ÿæ‚‰ã€‚å°½ç®¡æ‚¨ä¸éœ€è¦æœ‰
<a href="https://developers.google.com/google-apps/documents-list/">Google æ–‡æ¡£åˆ—è¡¨æ•°æ®
API</a>ï¼ˆæˆ–è€…å…¶ä»–
<a href="https://developers.google.com/gdata/">Google æ•°æ®
API</a>ï¼‰çš„å¼€å‘èƒŒæ™¯ï¼Œä½†æ˜¯ç†è§£è¿™ä¸€åè®®å¯èƒ½æœ‰æ‰€å¸®åŠ©ã€‚
</p>

<h2 id="getting-started"><!--@Getting started-->å…¥é—¨</h2>

<p>
<!--@First, copy the four library files from the Chromium source tree at -->
é¦–å…ˆï¼Œä»ä½äº
<a href="https://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/extensions/docs/examples/extensions/oauth_contacts/">.../examples/extensions/oauth_contacts/</a><!--@:-->
çš„ Chromium æºä»£ç æ ‘ä¸­å°†å¦‚ä¸‹å››ä¸ªåº“æ–‡ä»¶å¤åˆ¶åˆ°æ‚¨çš„è®¡ç®—æœºä¸Šï¼š
</p>
<ul>
<li><strong><a href="examples/extensions/oauth_contacts/chrome_ex_oauth.html" download="chrome_ex_oauth.html">chrome_ex_oauth.html</a></strong> - <!--@interstitial page for the oauth_callback URL-->ç”¨äºé‡å®šå‘è‡³ oauth_callback URL çš„ä¸­é—´é¡µé¢</li>
<li><strong><a href="examples/extensions/oauth_contacts/chrome_ex_oauth.js" download="chrome_ex_oauth.js">chrome_ex_oauth.js</a></strong> - <!--@core OAuth library-->æ ¸å¿ƒ OAuth åº“</li>
<li><strong><a href="examples/extensions/oauth_contacts/chrome_ex_oauthsimple.js" download="chrome_ex_oauthsimple.js">chrome_ex_oauthsimple.js</a></strong> - <!--@helpful wrapper for chrome_ex_oauth.js-->å¯¹ chrome_ex_oauth.js æœ‰ç”¨çš„åŒ…è£…</li>
<li><strong><a href="examples/extensions/oauth_contacts/onload.js" download="onload.js">onload.js</a></strong> -
<!--@initializes chrome_ex_oauth.html and redirects the page if needed to start the OAuth flow-->
åˆå§‹åŒ– chrome_ex_oauth.htmlï¼Œå¦‚æœéœ€è¦å¼€å§‹ OAuth æµç¨‹åˆ™é‡å®šå‘ç½‘é¡µ</li>
</ul>

<p><!--@Place the four library files in the root of your extension directory (or wherever your JavaScript is stored). Then include both .js files in your background page in the following order:-->
å°†è¿™å››ä¸ªåº“æ–‡ä»¶æ”¾åœ¨æ‚¨çš„æ‰©å±•ç¨‹åºçš„æ ¹ç›®å½•ä¸­ï¼ˆæˆ–è€…æ‚¨çš„
JavaScript
ä»£ç å­˜æ”¾çš„ä½ç½®ï¼Œç„¶ååœ¨æ‚¨çš„åå°ç½‘é¡µä¸­æŒ‰ç…§ä»¥ä¸‹é¡ºåºåŒ…å«é‚£ä¸¤ä¸ª
.js æ–‡ä»¶ï¼š
</p>

<pre>
&lt;script type="text/javascript" src="chrome_ex_oauthsimple.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="chrome_ex_oauth.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="onload.js"&gt;&lt;/script&gt;
</pre>

<p><!--@Your background page will manage the OAuth flow.-->æ‚¨çš„åå°ç½‘é¡µå°†ä¼šç®¡ç† OAuth æµç¨‹ã€‚</p>

<h2 id="oauth-dance"><!--@The OAuth dance in an extension-->æ‰©å±•ç¨‹åºä¸­çš„ OAuth è®¤è¯</h2>

<p>
<!--@If you are familiar with the OAuth protocol, you'll recall that the OAuth dance consists of three steps:-->
å¦‚æœæ‚¨å¯¹ OAuth åè®®æ¯”è¾ƒç†Ÿæ‚‰ï¼Œæ‚¨èƒ½å›æƒ³èµ·æ¥ OAuth è®¤è¯åŒ…æ‹¬ä¸‰ä¸ªæ­¥éª¤ï¼š
</p>

<ol>
<li><!--@fetching an initial request token-->è·å¾—åˆå§‹çš„è¯·æ±‚ä»¤ç‰Œ</li>
<li><!--@having the user authorize the request token-->è®©ç”¨æˆ·ä¸ºè¯·æ±‚ä»¤ç‰Œæˆæƒ</li>
<li><!--@fetching an access token-->è·å¾—è®¿é—®ä»¤ç‰Œ</li>
</ol>

<p><!--@In the context of an extension, this flow gets a bit tricky. Namely, there is no established consumer key/secret between the service provider and the application. That is, there is no web application URL for the user to be redirected to after the approval process.-->
åœ¨æ‰©å±•ç¨‹åºçš„ç¯å¢ƒä¸­ï¼Œè¿™ä¸€æµç¨‹é‡åˆ°äº†ä¸€äº›é—®é¢˜ã€‚åœ¨æœåŠ¡æä¾›å•†å’Œåº”ç”¨ä¹‹é—´æ— æ³•å»ºç«‹ä½¿ç”¨è€…å¯†é’¥/æœºå¯†ï¼Œåœ¨æˆæƒè¿‡ç¨‹ä¹‹åæ²¡æœ‰ç½‘ä¸Šåº”ç”¨çš„ URL è®©ç”¨æˆ·é‡å®šå‘ã€‚
</p>

<p>
<!--@Luckily, Google and a few other companies have been working on an <a href="http://code.google.com/apis/accounts/docs/OAuthForInstalledApps.html">OAuth for installed applications</a> solution that you can use from an extension environment. In the installed applications OAuth dance, the consumer key/secret are â€˜anonymousâ€™/â€™anonymousâ€™ and you provide an <em>application name</em> for the user to grant access to (instead of an application URL). The end result is the same: your background page requests the initial token, opens a new tab to the approval page, and finally makes the asynchronous call for the access token.-->
å¹¸è¿çš„æ˜¯ï¼ŒGoogle å’Œå¦å¤–å‡ å®¶å…¬å¸æ­£åœ¨å¼€å‘<a
href="https://code.google.com/apis/accounts/docs/OAuthForInstalledApps.html">ç”¨äºå·²å®‰è£…åº”ç”¨çš„
OAuth</a>è§£å†³æ–¹æ¡ˆï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ä»æ‰©å±•ç¨‹åºçš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚åœ¨å·²å®‰è£…åº”ç”¨çš„
OAuth
è®¤è¯è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨è€…å¯†é’¥/æœºå¯†ä¸º'anonymous'/'anonymous'ï¼Œæ‚¨è¿˜å¯ä»¥æä¾›ä¸€ä¸ª<em>åº”ç”¨åç§°</em>ï¼ˆè€Œä¸æ˜¯åº”ç”¨
URLï¼‰ï¼Œä½¿ç”¨æˆ·æˆäºˆè®¿é—®æƒé™ã€‚æœ€ç»ˆç»“æœæ˜¯ä¸€æ ·çš„ï¼šæ‚¨çš„åå°é¡µé¢è¯·æ±‚åˆå§‹ä»¤ç‰Œï¼Œæ‰“å¼€æ–°æ ‡ç­¾é¡µè¿›å…¥æˆæƒé¡µé¢ï¼Œæœ€åå‘å‡ºå¼‚æ­¥è°ƒç”¨è¯·æ±‚è®¿é—®ä»¤ç‰Œã€‚
</p>

<h3 id="set-code"><!--@Setup code-->è®¾ç½®ä»£ç </h3>

<p><!--@To initialize the library, create a-->
è¦åˆå§‹åŒ–åº“ï¼Œåœ¨åå°ç½‘é¡µä¸­åˆ›å»ºä¸€ä¸ª
<code>ChromeExOAuth</code> <!--@object in the background page:-->
å¯¹è±¡ï¼š
</p>

<pre>
var oauth = ChromeExOAuth.initBackgroundPage({
  'request_url': &lt;OAuth è¯·æ±‚ URL&gt;,
  'authorize_url': &lt;OAuth è®¤è¯ URL&gt;,
  'access_url': &lt;OAuth è®¿é—®ä»¤ç‰Œ URL&gt;,
  'consumer_key': &lt;OAuth æ¶ˆè´¹è€…å¯†é’¥&gt;,
  'consumer_secret': &lt;OAuth æ¶ˆè´¹è€…æœºå¯†&gt;,
  'scope': &lt;è¦è®¿é—®çš„æ•°æ®èŒƒå›´ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰ OAuth æä¾›å•†éƒ½ä½¿ç”¨å®ƒ&gt;,
  'app_name': &lt;åº”ç”¨åç§°ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰ OAuth æä¾›å•†éƒ½ä½¿ç”¨å®ƒ&gt;
});
</pre>

<p><!--@In the case of the Documents List API and Googleâ€™s OAuth endpoints, a possible initialization may be:-->
å¦‚æœæ˜¯æ–‡æ¡£åˆ—è¡¨ API å’Œ Google çš„ OAuth
ç«¯ç‚¹ï¼Œåˆå§‹åŒ–ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
</p>

<pre>
var oauth = ChromeExOAuth.initBackgroundPage({
  'request_url': 'https://www.google.com/accounts/OAuthGetRequestToken',
  'authorize_url': 'https://www.google.com/accounts/OAuthAuthorizeToken',
  'access_url': 'https://www.google.com/accounts/OAuthGetAccessToken',
  'consumer_key': 'anonymous',
  'consumer_secret': 'anonymous',
  'scope': 'https://docs.google.com/feeds/',
  'app_name': 'æˆ‘çš„ Google æ–‡æ¡£æ‰©å±•ç¨‹åº'
});
</pre>

<p>
<!--@To use the OAuth library,
you must declare the "tabs" permision in the
<a href="manifest.html">extension manifest</a>.
You must also declare the sites you are using
including the request URL, the authorize URL, access URL,
and, if necessary, the scope URL.
For example:-->
è¦ä½¿ç”¨ OAuth åº“ï¼Œæ‚¨å¿…é¡»åœ¨<a href="manifest.html">æ‰©å±•ç¨‹åºçš„æ¸…å•æ–‡ä»¶</a>ä¸­å£°æ˜
"tabs" æƒé™ï¼Œæ‚¨è¿˜å¿…é¡»å£°æ˜æ‚¨æ­£åœ¨ä½¿ç”¨çš„ç½‘ç«™ï¼ŒåŒ…æ‹¬è¯·æ±‚
URLã€è®¤è¯ URLã€è®¿é—® URLï¼Œå¦‚æœæœ‰å¿…è¦çš„è¯è¿˜æœ‰åŒºåŸŸ URLã€‚ä¾‹å¦‚ï¼š
</p>

<pre data-filename="manifest.json">
"permissions": [ "tabs", "https://docs.google.com/feeds/*",
  "https://www.google.com/accounts/OAuthGetRequestToken",
  "https://www.google.com/accounts/OAuthAuthorizeToken",
  "https://www.google.com/accounts/OAuthGetAccessToken"
]
</pre>

<h3 id="request-token"><!--@Fetching and authorizing a request token-->è·å–å’Œè®¤è¯è¯·æ±‚ä»¤ç‰Œ</h3>

<p>
<!--@Once you have your background page set up, call the <code>authorize()</code> function to begin the OAuth dance and redirect the user to the OAuth provider. The client library abstracts most of this process, so all you need to do is pass a callback to the <code>authorize()</code> function, and a new tab will open and redirect the user.-->
ä¸€æ—¦æ‚¨è®¾ç½®å¥½äº†åå°ç½‘é¡µåï¼Œå°±èƒ½è°ƒç”¨
<code>authorize()</code> å‡½æ•°ï¼Œå¼€å§‹ OAuth
è®¤è¯ï¼Œä½¿ç”¨æˆ·é‡å®šå‘è‡³ OAuth
æä¾›å•†ã€‚å®¢æˆ·ç«¯åº“æŠ½è±¡äº†è¿™ä¸€è¿‡ç¨‹çš„å¤§éƒ¨åˆ†ï¼Œæ‰€ä»¥æ‚¨éœ€è¦åšçš„åªæ˜¯å‘
<code>authorize()</code>
å‡½æ•°ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç„¶åä¼šæ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µï¼Œå¹¶é‡å®šå‘ã€‚
</p>

<pre>
oauth.authorize(function() {
  // ... å‡†å¤‡è·å–ä¸ªäººæ•°æ®...
});
</pre>

<p>
<!--@You don't need to provide any additional logic for storing the token and secret, as this library already stores these values in the browserâ€™s <code>localStorage</code>. If the library already has an access token stored for the current scope, then no tab will be opened. In either case, the callback will be called.-->
æ‚¨ä¸éœ€è¦æä¾›ä»»ä½•é¢å¤–çš„é€»è¾‘æ¥å­˜å‚¨ä»¤ç‰Œå’Œæœºå¯†ï¼Œå› ä¸ºè¯¥åº“å·²ç»åœ¨æµè§ˆå™¨çš„
<code>localStorage</code>
ä¸­å‚¨å­˜äº†è¿™äº›å€¼ã€‚å¦‚æœåº“å·²ç»ä¸ºå½“å‰ä½œç”¨åŸŸå‚¨å­˜äº†è®¿é—®ä»¤ç‰Œï¼Œåˆ™ä¸ç”¨å†æ‰“å¼€æ–°æ ‡ç­¾é¡µã€‚åœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œéƒ½ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚
</p>

<h3 id="signed-requests"><!--@Sending signed API requests-->å‘é€å·²ç­¾åçš„ API è¯·æ±‚</h3>

<p>
<!--@Once your specified callback is executed, call the <code>sendSignedRequest()</code> function to send signed requests to your API endpoint(s). <code>sendSignedRequest()</code> takes three arguments: a URI, a callback function, and an optional parameter object. The callback is passed two arguments: the response text and the <code>XMLHttpRequest</code> object that was used to make the request.-->
ä¸€æ—¦æ‚¨æŒ‡å®šçš„å›è°ƒå‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œå°±èƒ½è°ƒç”¨
<code>sendSignedRequest()</code>
å‡½æ•°ï¼Œå‘æ‚¨çš„ API å‘é€å·²ç­¾åçš„è¯·æ±‚ã€‚<code>sendSignedRequest()</code>
æœ‰ä¸‰ä¸ªå‚æ•°ï¼šURIã€å›è°ƒå‡½æ•°å’Œå¯é€‰çš„å‚æ•°å¯¹è±¡ã€‚å›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šå“åº”æ–‡æœ¬ä»¥åŠç”¨æ¥å‘å‡ºè¯·æ±‚çš„
<code>XMLHttpRequest</code> å¯¹è±¡ã€‚
</p>

<p><!--@This example sends an HTTP <code>GET</code>:-->
è¿™ä¸€ä¾‹å­å‘é€ä¸€ä¸ª HTTP <code>GET</code> è¯·æ±‚ï¼š
</p>

<pre>
function callback(resp, xhr) {
  // ... å¤„ç†æ–‡æœ¬å“åº” ...
};

function onAuthorized() {
  var url = 'https://docs.google.com/feeds/default/private/full';
  var request = {
    'method': 'GET',
    'parameters': {'alt': 'json'}
  };

  // å‘é€ï¼šGET https://docs.google.com/feeds/default/private/full?alt=json
  oauth.sendSignedRequest(url, callback, request);
};

oauth.authorize(onAuthorized);
</pre>

<p><!--@A more complex example using an HTTP <code>POST</code> might look like this:-->
ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ä½¿ç”¨ HTTP POST è¯·æ±‚ï¼Œå¦‚ä¸‹åˆ—ä»£ç æ‰€ç¤ºï¼š
</p>

<pre>
function onAuthorized() {
  var url = 'https://docs.google.com/feeds/default/private/full';
  var request = {
    'method': 'POST',
    'headers': {
      'GData-Version': '3.0',
      'Content-Type': 'application/atom+xml'
    },
    'parameters': {
      'alt': 'json'
    },
    'body': 'è¦å‘é€çš„æ•°æ®'
  };

  // å‘é€ï¼šPOST https://docs.google.com/feeds/default/private/full?alt=json
  oauth.sendSignedRequest(url, callback, request);
};
</pre>

<p>
<!--@By default, the <code>sendSignedRequest()</code> function sends the <code>oauth_*</code> parameters in the URL (by calling <code>oauth.signURL()</code>). If you prefer to send the <code>oauth_*</code> parameters in the <code>Authorization</code> header (or need direct access to the generated header), use <code>getAuthorizationHeader()</code>. Its arguments are a URI, an HTTP method, and an optional object of URL query parameters as key/value pairs.-->
é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>sendSignedRequest()</code>
å‡½æ•°åœ¨ URL ä¸­ï¼ˆé€šè¿‡è°ƒç”¨
<code>oauth.signURL()</code>ï¼‰å‘é€ <code>oauth_*</code>
å‚æ•°ã€‚å¦‚æœæ‚¨å¸Œæœ›åœ¨ <code>Authorization</code> å¤´ä¿¡æ¯ä¸­å‘é€
<code>oauth_*</code>
å‚æ•°ï¼ˆæˆ–è€…éœ€è¦ç›´æ¥è®¿é—®å·²ç”Ÿæˆçš„å¤´ä¿¡æ¯ï¼‰ï¼Œè¯·ä½¿ç”¨
<code>getAuthorizationHeader()</code>ã€‚å®ƒçš„å‚æ•°åŒ…æ‹¬
URLã€HTTP æ–¹æ³•ä»¥åŠå¯é€‰çš„ URL æŸ¥è¯¢å‚æ•°å¯¹è±¡ï¼Œè¡¨ç¤ºä¸ºé”®/å€¼å¯¹ã€‚
</p>

<p><!--@Here is the example above using <code>getAuthorizationHeader()</code> and an <code>XMLHttpRequest</code> object:-->
å¦‚ä¸‹æ˜¯ä¸Šé¢æ‰€è¯´å†…å®¹çš„ä¸€ä¸ªä¾‹å­ï¼Œä½¿ç”¨
<code>getAuthorizationHeader()</code> å’Œä¸€ä¸ª
<code>XMLHttpRequest</code>å¯¹è±¡ï¼š
</p>

<pre>
function stringify(parameters) {
  var params = [];
  for(var p in parameters) {
    params.push(encodeURIComponent(p) + '=' +
                encodeURIComponent(parameters[p]));
  }
  return params.join('&amp;');
};

function onAuthorized() {
  var method = 'POST';
  var url = 'https://docs.google.com/feeds/default/private/full';
  var params = {'alt': 'json'};

  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function(data) {
    callback(xhr, data);
  };
  xhr.open(method, url + '?' + stringify(params), true);
  xhr.setRequestHeader('GData-Version', '3.0');
  xhr.setRequestHeader('Content-Type', 'application/atom+xml');
  xhr.setRequestHeader('Authorization', oauth.getAuthorizationHeader(url, method, params));

  xhr.send('Data to send');
};
</pre>

<h2 id="sample-code"><!--@Sample code-->ç¤ºä¾‹ä»£ç </h2>

<p>
<!--@Sample extensions that use these techniques are available in the Chromium source tree:-->
ä½¿ç”¨è¿™äº›æŠ€æœ¯çš„ç¤ºä¾‹æ‰©å±•ç¨‹åºåœ¨ Chromium æºä»£ç æ ‘çš„å¦‚ä¸‹ä½ç½®å¯ç”¨ï¼š
</p>

<ul>
<li><a href="https://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/extensions/docs/examples/extensions/gdocs/">.../examples/extensions/gdocs/</a></li>
<li><a href="https://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/extensions/docs/examples/extensions/oauth_contacts/">.../examples/extensions/oauth_contacts/</a></li>
</ul>
      </div>
    </div>
  </body>

  <div id="gc-footer">
    <button class="google-button" id="scroll-to-top">â†‘</button>
    <button class="google-button" id="send-feedback" style="display:none">Send Feedback</button>
    <div class="text">
      <p>
        <!--@Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
        the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
        Attribution 3.0 License</a>, and code samples are licensed under the
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.-->
        è¯¥é¡µé¢ç¿»è¯‘è‡ª
        <a href="https://developer.chrome.com/extensions/">Google Chrome Extensions</a>
        ä¸
        <a href="https://developer.chrome.com/apps/">Google Chrome Apps</a>ã€‚é™¤éç‰¹åˆ«<a href="https://code.google.com/policies.html#restrictions">è¯´æ˜</a>ï¼Œè¯¥é¡µé¢çš„å†…å®¹éµå¾ª
        <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0
        License</a>ï¼Œä»£ç ç¤ºä¾‹éµå¾ª
        <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>ã€‚
      </p>
      <p class="crxdoczh-footer">
        <a href="https://code.google.com/p/crxdoczh/">crxdoczh é¡¹ç›®ä¸»é¡µ</a>
        <a href="https://code.google.com/p/crxdoczh/issues/entry?template=%E7%BD%91%E7%AB%99%E5%8F%8D%E9%A6%88">å‘é€åé¦ˆ</a>
        <a href="" rel="publisher">
          Google+ é¡µé¢
        </a>
        <a href="https://plus.google.com/communities/105384952265487436177">Google+ ç¤¾ç¾¤</a>
      </p>
      <script src="../../developer.chrome.com/static/js/platform_chooser.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/popup.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/prettify.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/scroll.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/sidebar.js" type="text/javascript"></script>
      <script src="../../developer.chrome.com/static/js/tabs.js" type="text/javascript"></script>
      <script>
        (function() {
          // Auto syntax highlight all pre tags.
          var preElements = document.getElementsByTagName('pre');
          for (var i = 0; i < preElements.length; i++) {
            var preElement = preElements[i];
            preElement.classList.add('prettyprint');
            var datasetFilename = preElement.getAttribute('data-filename');
            if (datasetFilename) {
              var filename = document.createElement('div');
              filename.className = 'filename nocode';
              filename.textContent = datasetFilename;
              preElement.insertBefore(filename, preElement.firstChild);
            }
          }
          prettyPrint();
        })();

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25062424-1']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = 'https://ssl.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

        window.___gcfg = {
      Â  Â  lang: 'zh-CN'
      Â  };
      Â  (function() {
      Â  Â  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      Â  Â  po.src = 'https://apis.google.com/js/plusone.js';
      Â  Â  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      Â  })();
      </script>
    </div>
  </div>
</html>
