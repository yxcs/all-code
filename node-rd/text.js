var str = 'Response body: {"ret":0,"errmsg":"ok","msg_count":6,"can_msg_continue":0,"general_msg_list":"{\"list\":[{\"comm_msg_info\":{\"id\":1000000006,\"type\":49,\"datetime\":1488270184,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"【科普】转载微信原创文章怎样避免侵权？\",\"digest\":\"关于原创文章转载的正确姿势，你学会了吗？\",\"content\":\"\",\"fileid\":100000184,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483836&amp;idx=1&amp;sn=30270fea03032666736a75c2745055a3&amp;chksm=e98ef99cdef9708aa5253d8eab059b604500aa6148a563ab4eb9da686cc029cab1a915bf168a&amp;scene=27#wechat_redirect\",\"source_url\":\"\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWg3YSXxia5uFkp3WkrPQMvhSwE0BFz7njYqvHCGZibIakqbq3T21SxCTbSdo86ndf2v3LrN6fnayR3Q\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":0,\"multi_app_msg_item_list\":[],\"author\":\"\",\"copyright_stat\":100}},{\"comm_msg_info\":{\"id\":1000000005,\"type\":49,\"datetime\":1487815794,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"西瓜素材库，99％以上的小编都不舍得分享的法宝\",\"digest\":\"如果你还在烦恼文章输出不足，不妨看这里。\",\"content\":\"\",\"fileid\":100000156,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483814&amp;idx=1&amp;sn=e1b8cd41ee39af470fc9102a4b80fe35&amp;chksm=e98ef986def97090aacf61576264c831c5fd10359511ed05b910b5624168ebe15ce21147f14d&amp;scene=27#wechat_redirect\",\"source_url\":\"\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWhezb2Fibv3k5MkgbCbrxMvGdyv6AJFpztEPjcp7euYRCkefWzoJU6wiaceyORS4QgMMjRlB2WcDtcA\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":1,\"multi_app_msg_item_list\":[{\"title\":\"公众号运营遇到瓶颈期该怎么办？\",\"digest\":\"“公众号怎么跳出冷启动阶段”，看完这个你就懂了。\",\"content\":\"\",\"fileid\":100000157,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483814&amp;idx=2&amp;sn=841d44c8bbcc87742d21a40eefbb187c&amp;chksm=e98ef986def97090cbee5f8d392997437ffeed1e45ab8e8d31f094333ce8e407c58fc633e076&amp;scene=27#wechat_redirect\",\"source_url\":\"\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWhezb2Fibv3k5MkgbCbrxMvGkicoWOvbd0ibwxBLrLvPGh7S5rbjLE1oWib2tPdc5bKvytttrp4GZz3WA\\\/0?wx_fmt=jpeg\",\"author\":\"\",\"copyright_stat\":100}],\"author\":\"\",\"copyright_stat\":100}},{\"comm_msg_info\":{\"id\":1000000004,\"type\":49,\"datetime\":1487298600,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"利用“传播指数”选文章的正确姿势\",\"digest\":\"文章阅读量低，是因为你不会选。\",\"content\":\"\",\"fileid\":100000039,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483689&amp;idx=1&amp;sn=aae45c220d7d9bc348dfdbecd171b7e8&amp;chksm=e98ef909def9701f27df542aba917c1d78c24304e970c2387aafb192ab0410e8195392a76913&amp;scene=27#wechat_redirect\",\"source_url\":\"\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWhRxh7sO5SFiasDu0NibqkhxZ3lR0XZsoD6LDh3ZpJrupaGwRaXHMJ3x0TlhAHdiccOLV72wfChAic7WQ\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":0,\"multi_app_msg_item_list\":[],\"author\":\"\",\"copyright_stat\":100}},{\"comm_msg_info\":{\"id\":1000000003,\"type\":49,\"datetime\":1486635944,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"三分钟教你玩转“西瓜助手”\",\"digest\":\"西瓜公众号助手新手指南\",\"content\":\"\",\"fileid\":100000014,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483686&amp;idx=1&amp;sn=c99bfc3695331aaa4fcdc9cf661b5501&amp;chksm=e98ef906def970102bddf52a9db2796a422e5243792e5ff8c87276576dad62dce26c2a37005c&amp;scene=27#wechat_redirect\",\"source_url\":\"http:\\\/\\\/www.xiguaji.com\\\/\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWjXhOVcsFbXMrRQCicic109aEchReicueLeROm64bqMZOGUmMSfSNyFDsiaGlcriaRN9Apm2EVsia86Pa4Q\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":0,\"multi_app_msg_item_list\":[],\"author\":\"\",\"copyright_stat\":100}},{\"comm_msg_info\":{\"id\":1000000002,\"type\":49,\"datetime\":1484731677,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"比10w+文章写作套路更重要的是，定期给公众号扫雷！\",\"digest\":\"常在河边走，哪有不湿鞋。\",\"content\":\"\",\"fileid\":100000006,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483657&amp;idx=1&amp;sn=fd3df7befc261843c42d83ac25cacde3&amp;chksm=e98ef929def9703f567e6a2e23fc2f91a31af613c170cd277bd31c3a75cf4408f6536aac42d5&amp;scene=27#wechat_redirect\",\"source_url\":\"http:\\\/\\\/zs.xiguaji.com\\\/Member#\\\/IllegalArticleDetection\\\/List\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWia7icq07f7cg4kJuqx4biaUw1pyb4QIB2wWJ6baMSwN5Xiaeb3FicPyZuzgAxVTrPBCzhQIo2JESL6YIw\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":0,\"multi_app_msg_item_list\":[],\"author\":\"\",\"copyright_stat\":100}},{\"comm_msg_info\":{\"id\":1000000001,\"type\":49,\"datetime\":1482806387,\"fakeid\":\"3249557327\",\"status\":2,\"content\":\"\"},\"app_msg_ext_info\":{\"title\":\"一分钟快速生成你的公众号2016运营年报，老司机带你开车啦！\",\"digest\":\"过去，阅读量是评判公众号好坏的唯一的指标。随着新媒体市场成熟，已经形成了更加精密的价值体系，10w+不再成为\",\"content\":\"\",\"fileid\":100000001,\"content_url\":\"http:\\\/\\\/mp.weixin.qq.com\\\/s?__biz=MzI0OTU1NzMyNw==&amp;mid=2247483651&amp;idx=1&amp;sn=41131ff876052b96b7f3f3e0ba5957e3&amp;chksm=e98ef923def97035a95f4516192877d6d715924c87cf32fcd5b53c8f2fca1636dcc531cd7e87&amp;scene=27#wechat_redirect\",\"source_url\":\"\",\"cover\":\"http:\\\/\\\/mmbiz.qpic.cn\\\/mmbiz_jpg\\\/maRztnnHlWjRJ1ibOXHASictkYOHiaibxnXcr81Lq4kGCXCoUvDDKpLPMFKmSuQZBysPQD33O6CCAibdzlaDSmpxL5Q\\\/0?wx_fmt=jpeg\",\"subtype\":9,\"is_multi\":0,\"multi_app_msg_item_list\":[],\"author\":\"西瓜君\",\"copyright_stat\":100}}]}"}'

/*file = fso.OpenTextFile("G:\\upload\\url.txt",8 ,true, true);
file.writeLine("Request url: " + oSession.url);
file.writeLine("Request header:" + "\n" + oSession.oRequest.headers);
file.writeLine("Request body: " + oSession.GetRequestBodyAsString());*/

if(str.indexOf('Response body: {"ret":0') > -1) {
	str = str.replace('\\','');
	var flag = true;
	var start = 1;
	while(flag) {
		var urlStart = str.indexOf('content_url', start);
		if(urlStart > 0) {
			var urlEnd = str.indexOf('#wechat_redirect', urlStart);
			var url =  str.substr(urlStart+3, (urlEnd+16)-(urlStart+3));
			start = urlEnd
			console.log(url);
		}else {
			flag =false;
		}
	}
}